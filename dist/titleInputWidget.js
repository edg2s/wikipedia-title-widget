!function(t){"use strict";var l={},a=l.hasOwnProperty;l.toString;function i(t,e,i){var n,o,s={},r=[];for(n=0,o=e.length;n<o;n++)s[e[n]]=!0;for(n=0,o=t.length;n<o;n++)!!s[t[n]]===i&&r.push(t[n]);return r}l.initClass=function(t){t.static=t.static||{}},l.inheritClass=function(t,e){var i;if(!e)throw new Error("inheritClass: Origin is not a function (actually "+e+")");if(t.prototype instanceof e)throw new Error("inheritClass: Target already inherits from origin");i=t.prototype.constructor,t.super=t.parent=e,t.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l.initClass(e),t.static=Object.create(e.static)},l.mixinClass=function(t,e){var i;if(!e)throw new Error("mixinClass: Origin is not a function (actually "+e+")");for(i in e.prototype)"constructor"!==i&&a.call(e.prototype,i)&&(t.prototype[i]=e.prototype[i]);if(l.initClass(t),e.static)for(i in e.static)a.call(e.static,i)&&(t.static[i]=e.static[i]);else l.initClass(e)},l.isSubclass=function(t,e){return t===e||t.prototype instanceof e},l.getProp=function(t){var e,i=t;for(e=1;e<arguments.length;e++){if(null==i)return;i=i[arguments[e]]}return i},l.setProp=function(t){var e,i=t;if(!(Object(t)!==t||arguments.length<2)){for(e=1;e<arguments.length-2;e++){if(void 0===i[arguments[e]]&&(i[arguments[e]]={}),Object(i[arguments[e]])!==i[arguments[e]])return;i=i[arguments[e]]}i[arguments[arguments.length-2]]=arguments[arguments.length-1]}},l.deleteProp=function(t){var e,i=t,n=[i];if(!(Object(t)!==t||arguments.length<2)){for(e=1;e<arguments.length-1;e++){if(void 0===i[arguments[e]]||Object(i[arguments[e]])!==i[arguments[e]])return;i=i[arguments[e]],n.push(i)}for(delete i[arguments[e]];1<n.length&&(i=n.pop())&&l.isPlainObject(i)&&!Object.keys(i).length;)delete n[n.length-1][arguments[n.length]]}},l.cloneObject=function(t){var e,i;for(e in i=Object.create(t.constructor.prototype),t)a.call(t,e)&&(i[e]=t[e]);return i},l.getObjectValues=function(t){var e,i;if(t!==Object(t))throw new TypeError("Called on non-object");for(e in i=[],t)a.call(t,e)&&(i[i.length]=t[e]);return i},l.binarySearch=function(t,e,i){for(var n,o,s=0,r=t.length;s<r;)if((o=e(t[n=s+r>>1]))<0)r=n;else{if(!(0<o))return n;s=n+1}return i?r:null},l.compare=function(t,e,i){var n,o,s,r;if(t===e)return!0;if(e=e||{},"number"==typeof(t=t||{}).nodeType&&"function"==typeof t.isEqualNode)return t.isEqualNode(e);for(r in t)if(a.call(t,r)&&void 0!==t[r]&&t[r]!==e[r]&&((s=typeof(n=t[r]))!==typeof(o=e[r])||("string"===s||"number"===s||"boolean"===s)&&n!==o||n===Object(n)&&!l.compare(n,o,!0)))return!1;return!!i||l.compare(e,t,!0)},l.copy=function(t,e,i){var n,o;if(i&&void 0!==(o=i(t)))return o;if(Array.isArray(t))o=new Array(t.length);else{if(t&&"function"==typeof t.clone)return e?e(t.clone()):t.clone();if(t&&"function"==typeof t.cloneNode)return e?e(t.cloneNode(!0)):t.cloneNode(!0);if(!l.isPlainObject(t))return e?e(t):t;o={}}for(n in t)o[n]=l.copy(t[n],e,i);return o},l.getHash=function(t){return JSON.stringify(t,l.getHash.keySortReplacer)},l.getHash.keySortReplacer=function(t,e){var i,n,o,s;if(e&&"function"==typeof e.getHashObject&&(e=e.getHashObject()),Array.isArray(e)||Object(e)!==e)return e;for(i={},o=0,s=(n=Object.keys(e).sort()).length;o<s;o+=1)i[n[o]]=e[n[o]];return i},l.unique=function(t){return t.reduce(function(t,e){return-1===t.indexOf(e)&&t.push(e),t},[])},l.simpleArrayUnion=function(){var t,e,i,n,o,s={},r=[];for(t=0,e=arguments.length;t<e;t++)for(n=0,o=(i=arguments[t]).length;n<o;n++)s[i[n]]||(s[i[n]]=!0,r.push(i[n]));return r},l.simpleArrayIntersection=function(t,e){return i(t,e,!0)},l.simpleArrayDifference=function(t,e){return i(t,e,!1)},l.isPlainObject=$.isPlainObject,function(){function s(t,e){if("string"==typeof t){if(null==e)throw new Error('Method name "'+t+'" has no context.');if("function"!=typeof e[t])throw new Error('Property "'+t+'" is not a function')}else if("function"!=typeof t)throw new Error("Invalid callback. Function or method name expected.")}function o(t,e,i){(a.call(t.bindings,e)?t.bindings[e]:t.bindings[e]=[]).push(i)}l.EventEmitter=function(){this.bindings={}},l.initClass(l.EventEmitter),l.EventEmitter.prototype.on=function(t,e,i,n){return s(e,n),o(this,t,{method:e,args:i,context:arguments.length<4?null:n,once:!1}),this},l.EventEmitter.prototype.once=function(t,e){return s(e),o(this,t,{method:e,args:void 0,context:null,once:!0}),this},l.EventEmitter.prototype.off=function(t,e,i){var n,o;if(1===arguments.length)return delete this.bindings[t],this;if(s(e,i),!a.call(this.bindings,t)||!this.bindings[t].length)return this;for(arguments.length<3&&(i=null),n=(o=this.bindings[t]).length;n--;)o[n].method===e&&o[n].context===i&&o.splice(n,1);return 0===o.length&&delete this.bindings[t],this},l.EventEmitter.prototype.emit=function(t){var e,i,n,o,s,r=[];if(a.call(this.bindings,t)){for(o=this.bindings[t].slice(),e=1,i=arguments.length;e<i;e++)r.push(arguments[e]);for(e=0,i=o.length;e<i;e++)s="string"==typeof(n=o[e]).method?n.context[n.method]:n.method,n.once&&this.off(t,s),s.apply(n.context,n.args?n.args.concat(r):r);return!0}return!1},l.EventEmitter.prototype.connect=function(t,e){var i,n,o;for(o in e)i=e[o],Array.isArray(i)?(n=i.slice(1),i=i[0]):n=[],this.on(o,i,n,t);return this},l.EventEmitter.prototype.disconnect=function(t,e){var i,n,o,s;if(e)for(n in e)o=e[n],Array.isArray(o)&&(o=o[0]),this.off(n,o,t);else for(n in this.bindings)for(i=(s=this.bindings[n]).length;i--;)s[i]&&s[i].context===t&&this.off(n,s[i].method,t);return this}}(),function(){function o(t,e){return void 0===e||e<0||e>=t.length?t.length:e}l.EmitterList=function(){this.items=[],this.aggregateItemEvents={}},l.EmitterList.prototype.getItems=function(){return this.items.slice(0)},l.EmitterList.prototype.getItemIndex=function(t){return this.items.indexOf(t)},l.EmitterList.prototype.getItemCount=function(){return this.items.length},l.EmitterList.prototype.isEmpty=function(){return!this.items.length},l.EmitterList.prototype.aggregate=function(t){var e,i,n,o,s,r;for(s in t){if(r=t[s],Object.prototype.hasOwnProperty.call(this.aggregateItemEvents,s)){if(r)throw new Error("Duplicate item event aggregation for "+s);for(e=0;e<this.items.length;e++)(i=this.items[e]).connect&&i.disconnect&&((o={})[s]=["emit",this.aggregateItemEvents[s],i],i.disconnect(this,o));delete this.aggregateItemEvents[s]}if(r)for(this.aggregateItemEvents[s]=r,e=0;e<this.items.length;e++)(i=this.items[e]).connect&&i.disconnect&&((n={})[s]=["emit",r,i],i.connect(this,n))}},l.EmitterList.prototype.addItems=function(t,e){var i,n;if(Array.isArray(t)||(t=[t]),0===t.length)return this;for(e=o(this.items,e),i=0;i<t.length;i++)-1!==(n=this.items.indexOf(t[i]))?(e=this.moveItem(t[i],e),this.emit("move",t[i],e,n)):(e=this.insertItem(t[i],e),this.emit("add",t[i],e)),e++;return this},l.EmitterList.prototype.moveItem=function(t,e){var i=this.items.indexOf(t);if(-1===i)throw new Error("Item cannot be moved, because it is not in the list.");return e=o(this.items,e),this.items.splice(i,1),i<e&&e--,this.items.splice(e,0,t),e},l.EmitterList.prototype.insertItem=function(t,e){var i,n;if(t.connect&&t.disconnect){for(n in i={},this.aggregateItemEvents)i[n]=["emit",this.aggregateItemEvents[n],t];t.connect(this,i)}return e=o(this.items,e),this.items.splice(e,0,t),e},l.EmitterList.prototype.removeItems=function(t){var e,i,n;if(Array.isArray(t)||(t=[t]),0===t.length)return this;for(e=0;e<t.length;e++)i=t[e],-1!==(n=this.items.indexOf(i))&&(i.connect&&i.disconnect&&i.disconnect(this),this.items.splice(n,1),this.emit("remove",i,n));return this},l.EmitterList.prototype.clearItems=function(){var t,e,i=this.items.splice(0,this.items.length);for(t=0;t<i.length;t++)(e=i[t]).connect&&e.disconnect&&e.disconnect(this);return this.emit("clear"),this}}(),l.SortedEmitterList=function(t){l.EmitterList.call(this),this.sortingCallback=t,this.aggregate({sortChange:"itemSortChange"}),this.connect(this,{itemSortChange:"onItemSortChange"})},l.mixinClass(l.SortedEmitterList,l.EmitterList),l.SortedEmitterList.prototype.onItemSortChange=function(t){this.removeItems(t),this.addItems(t)},l.SortedEmitterList.prototype.setSortingCallback=function(t){var e=this.getItems();this.sortingCallback=t,this.clearItems(),this.addItems(e)},l.SortedEmitterList.prototype.addItems=function(t){var e,i,n;if(Array.isArray(t)||(t=[t]),0===t.length)return this;for(i=0;i<t.length;i++)(n=this.findInsertionIndex(t[i]))<=this.items.length&&this.items[n]&&0===this.sortingCallback(this.items[n],t[i])&&this.removeItems(this.items[n]),e=this.insertItem(t[i],n),this.emit("add",t[i],e);return this},l.SortedEmitterList.prototype.findInsertionIndex=function(e){var i=this;return l.binarySearch(this.items,function(t){return i.sortingCallback(e,t)},!0)},l.Registry=function(){l.EventEmitter.call(this),this.registry={}},l.mixinClass(l.Registry,l.EventEmitter),l.Registry.prototype.register=function(t,e){var i,n;if("string"==typeof t)this.registry[t]=e,this.emit("register",t,e);else{if(!Array.isArray(t))throw new Error("Name must be a string or array, cannot be a "+typeof t);for(i=0,n=t.length;i<n;i++)this.register(t[i],e)}},l.Registry.prototype.unregister=function(t){var e,i,n;if("string"==typeof t)void 0!==(n=this.lookup(t))&&(delete this.registry[t],this.emit("unregister",t,n));else{if(!Array.isArray(t))throw new Error("Name must be a string or array, cannot be a "+typeof t);for(e=0,i=t.length;e<i;e++)this.unregister(t[e])}},l.Registry.prototype.lookup=function(t){if(a.call(this.registry,t))return this.registry[t]},l.Factory=function(){l.Factory.super.call(this)},l.inheritClass(l.Factory,l.Registry),l.Factory.prototype.register=function(t){var e;if("function"!=typeof t)throw new Error("constructor must be a function, cannot be a "+typeof t);if("string"!=typeof(e=t.static&&t.static.name)||""===e)throw new Error("Name must be a string and must not be empty");l.Factory.super.prototype.register.call(this,e,t)},l.Factory.prototype.unregister=function(t){var e;if("function"!=typeof t)throw new Error("constructor must be a function, cannot be a "+typeof t);if("string"!=typeof(e=t.static&&t.static.name)||""===e)throw new Error("Name must be a string and must not be empty");l.Factory.super.prototype.unregister.call(this,e)},l.Factory.prototype.create=function(t){var e,i,n=[],o=this.lookup(t);if(!o)throw new Error("No class registered by that name: "+t);for(i=1;i<arguments.length;i++)n.push(arguments[i]);return e=Object.create(o.prototype),o.apply(e,n),e},"undefined"!=typeof module&&module.exports?module.exports=l:t.OO=l}(this),OO.ui={},OO.ui.bind=$.proxy,OO.ui.Keys={UNDEFINED:0,BACKSPACE:8,DELETE:46,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,END:35,HOME:36,TAB:9,PAGEUP:33,PAGEDOWN:34,ESCAPE:27,SHIFT:16,SPACE:32},OO.ui.MouseButtons={LEFT:1,MIDDLE:2,RIGHT:3},OO.ui.elementId=0,OO.ui.generateElementId=function(){return OO.ui.elementId++,"ooui-"+OO.ui.elementId},OO.ui.isFocusableElement=function(t){var e,i=t[0];return!i.disabled&&(!(!$.expr.pseudos.visible(i)||t.parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length)&&("true"===i.contentEditable||(0<=t.prop("tabIndex")||(e=i.nodeName.toLowerCase(),-1!==["input","select","textarea","button","object"].indexOf(e)||("a"===e||"area"===e)&&void 0!==t.attr("href")))))},OO.ui.findFocusable=function(t,e){var i=$([]),n=t.find("input, select, textarea, button, object, a, area, [contenteditable], [tabindex]");return e&&(n=Array.prototype.reverse.call(n)),n.each(function(){var t=$(this);if(OO.ui.isFocusableElement(t))return i=t,!1}),i},OO.ui.getUserLanguages=function(){return["en"]},OO.ui.getLocalValue=function(t,e,i){var n,o,s;if(t[e])return t[e];for(n=0,o=(s=OO.ui.getUserLanguages()).length;n<o;n++)if(t[e=s[n]])return t[e];if(t[i])return t[i];for(e in t)return t[e]},OO.ui.contains=function(t,e,i){var n;for(Array.isArray(t)||(t=[t]),n=t.length-1;0<=n;n--)if(i&&e===t[n]||$.contains(t[n],e))return!0;return!1},OO.ui.debounce=function(i,n,o){var s;return function(){var t=this,e=arguments;o&&!s&&i.apply(t,e),s&&!n||(clearTimeout(s),s=setTimeout(function(){s=null,o||i.apply(t,e)},n))}},OO.ui.warnDeprecation=function(t){void 0!==OO.getProp(window,"console","warn")&&console.warn(t)},OO.ui.throttle=function(t,e){var i,n,o,s=0,r=function(){o=null,s=Date.now(),t.apply(i,n)};return function(){var t=e-(Date.now()-s);i=this,n=arguments,t<=0?(clearTimeout(o),r()):o||(o=setTimeout(r,t))}},OO.ui.now=function(){return OO.ui.warnDeprecation("OO.ui.now() is deprecated, use Date.now() instead"),Date.now()},OO.ui.infuse=function(t,e){return OO.ui.Element.static.infuse(t,e)},OO.ui.msg=function(t){var e=OO.ui.msg.messages[t],n=Array.prototype.slice.call(arguments,1);return e="string"==typeof e?e.replace(/\$(\d+)/g,function(t,e){var i=parseInt(e,10);return void 0!==n[i-1]?n[i-1]:"$"+e}):"["+t+"]"},OO.ui.deferMsg=function(){var t=arguments;return function(){return OO.ui.msg.apply(OO.ui,t)}},OO.ui.resolveMsg=function(t){return"function"==typeof t?t():t},OO.ui.isSafeUrl=function(t){var e,i;function n(t,e){return t.substr(0,e.length)===e}if(i=["bitcoin","ftp","ftps","geo","git","gopher","http","https","irc","ircs","magnet","mailto","mms","news","nntp","redis","sftp","sip","sips","sms","ssh","svn","tel","telnet","urn","worldwind","xmpp"],""===t)return!0;for(e=0;e<i.length;e++)if(n(t,i[e]+":"))return!0;return!(!n(t,"/")&&!n(t,"./"))||!(!n(t,"?")&&!n(t,"#"))},OO.ui.isMobile=function(){return!1},OO.ui.getViewportSpacing=function(){return{top:0,right:0,bottom:0,left:0}},OO.ui.getDefaultOverlay=function(){return OO.ui.$defaultOverlay||(OO.ui.$defaultOverlay=$("<div>").addClass("oo-ui-defaultOverlay"),$(document.body).append(OO.ui.$defaultOverlay)),OO.ui.$defaultOverlay},OO.ui.mixin={},OO.ui.HtmlSnippet=function(t){this.content=t},OO.initClass(OO.ui.HtmlSnippet),OO.ui.HtmlSnippet.prototype.toString=function(){return this.content},OO.ui.Theme=function(){this.elementClassesQueue=[],this.debouncedUpdateQueuedElementClasses=OO.ui.debounce(this.updateQueuedElementClasses)},OO.initClass(OO.ui.Theme),OO.ui.Theme.prototype.getElementClasses=function(){return{on:[],off:[]}},OO.ui.Theme.prototype.updateElementClasses=function(t){var e=$([]),i=this.getElementClasses(t);t.$icon&&(e=e.add(t.$icon)),t.$indicator&&(e=e.add(t.$indicator)),e.removeClass(i.off).addClass(i.on)},OO.ui.Theme.prototype.updateQueuedElementClasses=function(){var t;for(t=0;t<this.elementClassesQueue.length;t++)this.updateElementClasses(this.elementClassesQueue[t]);this.elementClassesQueue=[]},OO.ui.Theme.prototype.queueUpdateElementClasses=function(t){-1===this.elementClassesQueue.lastIndexOf(t)&&(this.elementClassesQueue.push(t),this.debouncedUpdateQueuedElementClasses())},OO.ui.Theme.prototype.getDialogTransitionDuration=function(){return 0},OO.ui.Element=function(t){OO.ui.isDemo&&(this.initialConfig=t),t=t||{},this.$=function(){return OO.ui.warnDeprecation("this.$ is deprecated, use global $ instead"),$.apply(this,arguments)},this.elementId=null,this.visible=!0,this.data=t.data,this.$element=t.$element||$(document.createElement(this.getTagName())),this.elementGroup=null,Array.isArray(t.classes)&&this.$element.addClass(t.classes),t.id&&this.setElementId(t.id),t.text&&this.$element.text(t.text),t.content&&this.$element.append(t.content.map(function(t){return"string"==typeof t?t?document.createTextNode(t):void 0:t instanceof OO.ui.HtmlSnippet?t.toString():t instanceof OO.ui.Element?t.$element:t})),t.$content&&this.$element.append(t.$content)},OO.initClass(OO.ui.Element),OO.ui.Element.static.tagName="div",OO.ui.Element.static.infuse=function(t,e){var i=OO.ui.Element.static.unsafeInfuse(t,e,!1);return"string"==typeof t&&OO.ui.warnDeprecation("Passing a string ID to infuse is deprecated. Use an HTMLElement or jQuery collection instead."),i},OO.ui.Element.static.unsafeInfuse=function(t,i,n){var e,o,s,r,l,a,u,c,h,p,d;if("string"==typeof t?(e=t,o=$(document.getElementById(e))):e=(o=$(t)).attr("id"),!o.length)throw s="string"==typeof t?"Widget not found: "+t:t&&t.selector?"Widget not found: "+t.selector:"Widget not found",new Error(s);if(o[0].oouiInfused&&(o=o[0].oouiInfused),r=o.data("ooui-infused")){if(!0===r)throw new Error("Circular dependency! "+e);return n&&(p=r.constructor.static.gatherPreInfuseState(o,r),n.done(r.restorePreInfuseState.bind(r,p)),(d=o.data("ooui-infused-children"))&&d.length&&d.forEach(function(t){var e=t.constructor.static.gatherPreInfuseState(o,t);n.done(t.restorePreInfuseState.bind(t,e))})),r}if(!(r=o.attr("data-ooui")))throw new Error("No infusion data found: "+e);try{r=JSON.parse(r)}catch(t){r=null}if(!r||!r._)throw new Error("No valid infusion data found: "+e);if("Tag"===r._)return new OO.ui.Element($.extend({},i,{$element:o}));if(a=r._.split("."),void 0===(l=OO.getProp.apply(OO,[window].concat(a))))throw new Error("Unknown widget type: id: "+e+", class: "+r._);for(u=l.parent;void 0!==u&&u!==OO.ui.Element;)u=u.parent;if(u!==OO.ui.Element)throw new Error("Unknown widget type: id: "+e+", class: "+r._);return n||(h=$.Deferred(),n=h.promise()),o.data("ooui-infused",!0),r.id=e,d=[],r=OO.copy(r,null,function(t){var e;if(OO.isPlainObject(t)){if(t.tag)return e=OO.ui.Element.static.unsafeInfuse(t.tag,i,n),d.push(e),d.push.apply(d,e.$element.data("ooui-infused-children")||[]),e.$element.removeData("ooui-infused-children"),e;if(void 0!==t.html)return new OO.ui.HtmlSnippet(t.html)}}),r=l.static.reusePreInfuseDOM(o[0],r),p=l.static.gatherPreInfuseState(o[0],r),c=new l($.extend({},i,r)),o[0].oouiInfused=c.$element,h&&(o[0]!==c.$element[0]&&o.replaceWith(c.$element),h.resolve()),c.$element.data("ooui-infused",c),c.$element.data("ooui-infused-children",d),c.$element.attr("data-ooui",""),n.done(c.restorePreInfuseState.bind(c,p)),c},OO.ui.Element.static.reusePreInfuseDOM=function(t,e){return e},OO.ui.Element.static.gatherPreInfuseState=function(){return{}},OO.ui.Element.static.getJQuery=function(t,e){function i(t){return $(t,i.context)}return i.context=this.getDocument(t),e&&(i.$iframe=e),i},OO.ui.Element.static.getDocument=function(t){return t[0]&&t[0].ownerDocument||t.context||t.ownerDocument||t.document||t.nodeType===Node.DOCUMENT_NODE&&t||null},OO.ui.Element.static.getWindow=function(t){return this.getDocument(t).defaultView},OO.ui.Element.static.getDir=function(t){var e,i;return t instanceof $&&(t=t[0]),e=t.nodeType===Node.DOCUMENT_NODE,i=void 0!==t.document,(e||i)&&(i&&(t=t.document),t=t.body),$(t).css("direction")},OO.ui.Element.static.getFrameOffset=function(t,e,i){var n,o,s,r,l;if(e||(e=window),i||(i={top:0,left:0}),t.parent===t)return i;for(n=0,o=(s=t.parent.document.getElementsByTagName("iframe")).length;n<o;n++)if(s[n].contentWindow===t){r=s[n];break}return r&&(l=r.getBoundingClientRect(),i.left+=l.left,i.top+=l.top,t!==e&&this.getFrameOffset(t.parent,i)),i},OO.ui.Element.static.getRelativePosition=function(t,e){for(var i,n,o=t.offset(),s=e.offset(),r=this.getDocument(t),l=this.getDocument(e);r!==l;){if(!(i=r.defaultView.frameElement))throw new Error("$element frame is not contained in $anchor frame");n=$(i).offset(),o.left+=n.left,o.top+=n.top,r=i.ownerDocument}return o.left-=s.left,o.top-=s.top,o},OO.ui.Element.static.getBorders=function(t){var e=t.ownerDocument.defaultView.getComputedStyle(t,null),i=$(t);return{top:parseFloat(e?e.borderTopWidth:i.css("borderTopWidth"))||0,left:parseFloat(e?e.borderLeftWidth:i.css("borderLeftWidth"))||0,bottom:parseFloat(e?e.borderBottomWidth:i.css("borderBottomWidth"))||0,right:parseFloat(e?e.borderRightWidth:i.css("borderRightWidth"))||0}},OO.ui.Element.static.getDimensions=function(t){var e,i,n=t.ownerDocument||t.document,o=n.defaultView;return o===t||t===n.documentElement?{borders:{top:0,left:0,bottom:0,right:0},scroll:{top:(i=$(o)).scrollTop(),left:i.scrollLeft()},scrollbar:{right:0,bottom:0},rect:{top:0,left:0,bottom:i.innerHeight(),right:i.innerWidth()}}:(e=$(t),{borders:this.getBorders(t),scroll:{top:e.scrollTop(),left:e.scrollLeft()},scrollbar:{right:e.innerWidth()-t.clientWidth,bottom:e.innerHeight()-t.clientHeight},rect:t.getBoundingClientRect()})},OO.ui.Element.static.getScrollLeft=function(){var s=null;return function(t){var e,i,n=t.window===t||t===t.ownerDocument.body||t===t.ownerDocument.documentElement,o=n?$(window).scrollLeft():t.scrollLeft;return"rtl"===(n?"ltr":$(t).css("direction"))&&(null===s&&(e=$("<div>").attr({dir:"rtl",style:"font-size: 14px; width: 4px; height: 1px; position: absolute; top: -1000px; overflow: scroll;"}).text("ABCD"),i=e[0],e.appendTo("body"),s=0<i.scrollLeft?"default":(i.scrollLeft=1,0===i.scrollLeft?"negative":"reverse"),e.remove()),"reverse"===s?o=-o:"default"===s&&(o=o-t.scrollWidth+t.clientWidth)),o}}(),OO.ui.Element.static.getRootScrollableElement=function(t){var e,i;return void 0===OO.ui.scrollableElement&&(e=(i=t.ownerDocument.body).scrollTop,(i.scrollTop=1)===Math.round(i.scrollTop)?(i.scrollTop=e,OO.ui.scrollableElement="body"):OO.ui.scrollableElement="documentElement"),t.ownerDocument[OO.ui.scrollableElement]},OO.ui.Element.static.getClosestScrollableContainer=function(t,e){var i,n,o=["overflow-x","overflow-y"],s=$(t).parent();if("x"!==e&&"y"!==e||(o=["overflow-"+e]),$(t).is("html, body"))return this.getRootScrollableElement(t);for(;s.length;){if(s[0]===this.getRootScrollableElement(t))return s[0];for(i=o.length;i--;)if("auto"===(n=s.css(o[i]))||"scroll"===n)return s[0];s=s.parent()}return this.getRootScrollableElement(t)},OO.ui.Element.static.scrollIntoView=function(t,e){var i,n,o,s,r,l,a,u,c,h,p=$.Deferred();if(e=e||{},u=$.extend({top:0,bottom:0,left:0,right:0},e.padding),c=!1!==e.animate,n={},r=t instanceof HTMLElement?this.getDimensions(t).rect:t,o=e.scrollContainer||(t instanceof HTMLElement?this.getClosestScrollableContainer(t,e.direction):this.getClosestScrollableContainer(document.body)),s=$(o),l=this.getDimensions(o),a=$(this.getWindow(o)),i=s.is("html, body")?{top:r.top,bottom:a.innerHeight()-r.bottom,left:r.left,right:a.innerWidth()-r.right}:{top:r.top-(l.rect.top+l.borders.top),bottom:l.rect.bottom-l.borders.bottom-l.scrollbar.bottom-r.bottom,left:r.left-(l.rect.left+l.borders.left),right:l.rect.right-l.borders.right-l.scrollbar.right-r.right},e.direction&&"y"!==e.direction||(i.top<u.top?n.scrollTop=l.scroll.top+i.top-u.top:i.bottom<u.bottom&&(n.scrollTop=l.scroll.top+Math.min(i.top-u.top,-i.bottom+u.bottom))),e.direction&&"x"!==e.direction||(i.left<u.left?n.scrollLeft=l.scroll.left+i.left-u.left:i.right<u.right&&(n.scrollLeft=l.scroll.left+Math.min(i.left-u.left,-i.right+u.right))),$.isEmptyObject(n))p.resolve();else if(c)s.stop(!0).animate(n,void 0===e.duration?"fast":e.duration),s.queue(function(t){p.resolve(),t()});else{for(h in s.stop(!0),n)s[h](n[h]);p.resolve()}return p.promise()},OO.ui.Element.static.reconsiderScrollbars=function(t){var e,i,n,o,s=[];for(n=t.scrollLeft,o=t.scrollTop;t.firstChild;)s.push(t.firstChild),t.removeChild(t.firstChild);for(t.offsetHeight,e=0,i=s.length;e<i;e++)t.appendChild(s[e]);t.scrollLeft=n,t.scrollTop=o},OO.ui.Element.prototype.toggle=function(t){return(t=void 0===t?!this.visible:!!t)!==this.isVisible()&&(this.visible=t,this.$element.toggleClass("oo-ui-element-hidden",!this.visible),this.emit("toggle",t)),this},OO.ui.Element.prototype.isVisible=function(){return this.visible},OO.ui.Element.prototype.getData=function(){return this.data},OO.ui.Element.prototype.setData=function(t){return this.data=t,this},OO.ui.Element.prototype.setElementId=function(t){return this.elementId=t,this.$element.attr("id",t),this},OO.ui.Element.prototype.getElementId=function(){return null===this.elementId&&this.setElementId(OO.ui.generateElementId()),this.elementId},OO.ui.Element.prototype.supports=function(t){var e,i,n=0;for(e=0,i=(t=Array.isArray(t)?t:[t]).length;e<i;e++)"function"==typeof this[t[e]]&&n++;return t.length===n},OO.ui.Element.prototype.updateThemeClasses=function(){OO.ui.theme.queueUpdateElementClasses(this)},OO.ui.Element.prototype.getTagName=function(){return this.constructor.static.tagName},OO.ui.Element.prototype.isElementAttached=function(){return $.contains(this.getElementDocument(),this.$element[0])},OO.ui.Element.prototype.getElementDocument=function(){return OO.ui.Element.static.getDocument(this.$element)},OO.ui.Element.prototype.getElementWindow=function(){return OO.ui.Element.static.getWindow(this.$element)},OO.ui.Element.prototype.getClosestScrollableElementContainer=function(){return OO.ui.Element.static.getClosestScrollableContainer(this.$element[0])},OO.ui.Element.prototype.getElementGroup=function(){return this.elementGroup},OO.ui.Element.prototype.setElementGroup=function(t){return this.elementGroup=t,this},OO.ui.Element.prototype.scrollElementIntoView=function(t){return!this.isElementAttached()||!this.isVisible()||this.getElementGroup()&&!this.getElementGroup().isVisible()?$.Deferred().resolve():OO.ui.Element.static.scrollIntoView(this.$element[0],t)},OO.ui.Element.prototype.restorePreInfuseState=function(){},OO.ui.Widget=function(t){t=$.extend({disabled:!1},t),OO.ui.Widget.parent.call(this,t),OO.EventEmitter.call(this),this.disabled=null,this.wasDisabled=null,this.$element.addClass("oo-ui-widget"),this.setDisabled(!!t.disabled)},OO.inheritClass(OO.ui.Widget,OO.ui.Element),OO.mixinClass(OO.ui.Widget,OO.EventEmitter),OO.ui.Widget.prototype.isDisabled=function(){return this.disabled},OO.ui.Widget.prototype.setDisabled=function(t){var e;return this.disabled=!!t,(e=this.isDisabled())!==this.wasDisabled&&(this.$element.toggleClass("oo-ui-widget-disabled",e),this.$element.toggleClass("oo-ui-widget-enabled",!e),this.$element.attr("aria-disabled",e.toString()),this.emit("disable",e),this.updateThemeClasses()),this.wasDisabled=e,this},OO.ui.Widget.prototype.updateDisabled=function(){return this.setDisabled(this.disabled),this},OO.ui.Widget.prototype.getInputId=function(){return null},OO.ui.Widget.prototype.simulateLabelClick=function(){},OO.ui.mixin.FlaggedElement=function(t){t=t||{},this.flags={},this.$flagged=null,this.setFlags(t.flags||this.constructor.static.flags),this.setFlaggedElement(t.$flagged||this.$element)},OO.initClass(OO.ui.mixin.FlaggedElement),OO.ui.mixin.FlaggedElement.static.flags=null,OO.ui.mixin.FlaggedElement.prototype.setFlaggedElement=function(t){var e=Object.keys(this.flags).map(function(t){return"oo-ui-flaggedElement-"+t});this.$flagged&&this.$flagged.removeClass(e),this.$flagged=t.addClass(e)},OO.ui.mixin.FlaggedElement.prototype.hasFlag=function(t){return this.flags&&t in this.flags},OO.ui.mixin.FlaggedElement.prototype.getFlags=function(){return Object.keys(this.flags||{})},OO.ui.mixin.FlaggedElement.prototype.clearFlags=function(){var t,e,i={},n=[];for(t in this.flags)e="oo-ui-flaggedElement-"+t,i[t]=!1,delete this.flags[t],n.push(e);return this.$flagged&&this.$flagged.removeClass(n),this.updateThemeClasses(),this.emit("flag",i),this},OO.ui.mixin.FlaggedElement.prototype.setFlags=function(t){var e,i,n,o,s={},r=[],l=[],a="oo-ui-flaggedElement-";if("string"==typeof t)o=a+t,this.flags[t]||(this.flags[t]=!0,r.push(o));else if(Array.isArray(t))for(e=0,i=t.length;e<i;e++)o=a+(n=t[e]),this.flags[n]||(s[n]=!0,this.flags[n]=!0,r.push(o));else if(OO.isPlainObject(t))for(n in t)o=a+n,t[n]?this.flags[n]||(s[n]=!0,this.flags[n]=!0,r.push(o)):this.flags[n]&&(s[n]=!1,delete this.flags[n],l.push(o));return this.$flagged&&this.$flagged.addClass(r).removeClass(l),this.updateThemeClasses(),this.emit("flag",s),this},OO.ui.mixin.TabIndexedElement=function(t){t=$.extend({tabIndex:0},t),this.$tabIndexed=null,this.tabIndex=null,this.connect(this,{disable:"onTabIndexedElementDisable"}),this.setTabIndex(t.tabIndex),this.setTabIndexedElement(t.$tabIndexed||this.$element)},OO.initClass(OO.ui.mixin.TabIndexedElement),OO.ui.mixin.TabIndexedElement.prototype.setTabIndexedElement=function(t){var e=this.tabIndex;return this.setTabIndex(null),this.$tabIndexed=t,this.tabIndex=e,this.updateTabIndex()},OO.ui.mixin.TabIndexedElement.prototype.setTabIndex=function(t){return t=/^-?\d+$/.test(t)?Number(t):null,this.tabIndex!==t&&(this.tabIndex=t,this.updateTabIndex()),this},OO.ui.mixin.TabIndexedElement.prototype.updateTabIndex=function(){return this.$tabIndexed&&(null!==this.tabIndex?this.$tabIndexed.attr({tabindex:this.isDisabled()?-1:this.tabIndex,"aria-disabled":this.isDisabled().toString()}):this.$tabIndexed.removeAttr("tabindex aria-disabled")),this},OO.ui.mixin.TabIndexedElement.prototype.onTabIndexedElementDisable=function(){this.updateTabIndex()},OO.ui.mixin.TabIndexedElement.prototype.getTabIndex=function(){return this.tabIndex},OO.ui.mixin.TabIndexedElement.prototype.getInputId=function(){var t;return this.$tabIndexed&&this.isLabelableNode(this.$tabIndexed)?(void 0===(t=this.$tabIndexed.attr("id"))&&(t=OO.ui.generateElementId(),this.$tabIndexed.attr("id",t)),t):null},OO.ui.mixin.TabIndexedElement.prototype.isLabelableNode=function(t){var e=(t.prop("tagName")||"").toLowerCase();return"input"===e&&"hidden"!==t.attr("type")||-1!==["button","meter","output","progress","select","textarea"].indexOf(e)},OO.ui.mixin.TabIndexedElement.prototype.focus=function(){return this.isDisabled()||this.$tabIndexed.trigger("focus"),this},OO.ui.mixin.TabIndexedElement.prototype.blur=function(){return this.$tabIndexed.trigger("blur"),this},OO.ui.mixin.TabIndexedElement.prototype.simulateLabelClick=function(){this.focus()},OO.ui.mixin.TitledElement=function(t){t=t||{},this.$titled=null,this.title=null,this.setTitle(void 0!==t.title?t.title:this.constructor.static.title),this.setTitledElement(t.$titled||this.$element)},OO.initClass(OO.ui.mixin.TitledElement),OO.ui.mixin.TitledElement.static.title=null,OO.ui.mixin.TitledElement.prototype.setTitledElement=function(t){this.$titled&&this.$titled.removeAttr("title"),this.$titled=t,this.updateTitle()},OO.ui.mixin.TitledElement.prototype.setTitle=function(t){return t="string"==typeof(t="function"==typeof t?OO.ui.resolveMsg(t):t)?t:null,this.title!==t&&(this.title=t,this.updateTitle()),this},OO.ui.mixin.TitledElement.prototype.updateTitle=function(){var t=this.getTitle();return this.$titled&&(null!==t?(this.formatTitleWithAccessKey&&(t=this.formatTitleWithAccessKey(t)),this.$titled.attr("title",t)):this.$titled.removeAttr("title")),this},OO.ui.mixin.TitledElement.prototype.getTitle=function(){return this.title},OO.ui.mixin.AccessKeyedElement=function(t){t=t||{},this.$accessKeyed=null,this.accessKey=null,this.setAccessKey(t.accessKey||null),this.setAccessKeyedElement(t.$accessKeyed||this.$element),this.updateTitle&&this.updateTitle()},OO.initClass(OO.ui.mixin.AccessKeyedElement),OO.ui.mixin.AccessKeyedElement.static.accessKey=null,OO.ui.mixin.AccessKeyedElement.prototype.setAccessKeyedElement=function(t){this.$accessKeyed&&this.$accessKeyed.removeAttr("accesskey"),this.$accessKeyed=t,this.accessKey&&this.$accessKeyed.attr("accesskey",this.accessKey)},OO.ui.mixin.AccessKeyedElement.prototype.setAccessKey=function(t){return t="string"==typeof t?OO.ui.resolveMsg(t):null,this.accessKey!==t&&(this.$accessKeyed&&(null!==t?this.$accessKeyed.attr("accesskey",t):this.$accessKeyed.removeAttr("accesskey")),this.accessKey=t,this.updateTitle&&this.updateTitle()),this},OO.ui.mixin.AccessKeyedElement.prototype.getAccessKey=function(){return this.accessKey},OO.ui.mixin.AccessKeyedElement.prototype.formatTitleWithAccessKey=function(t){var e;return this.$accessKeyed&&(e=$.fn.updateTooltipAccessKeys&&$.fn.updateTooltipAccessKeys.getAccessKeyLabel?$.fn.updateTooltipAccessKeys.getAccessKeyLabel(this.$accessKeyed[0]):this.getAccessKey())&&(t+=" ["+e+"]"),t},OO.ui.InputWidget=function(t){t=t||{},OO.ui.InputWidget.parent.call(this,t),this.$input=t.$input||this.getInputElement(t),this.value="",this.inputFilter=t.inputFilter,OO.ui.mixin.TabIndexedElement.call(this,$.extend({$tabIndexed:this.$input},t)),OO.ui.mixin.TitledElement.call(this,$.extend({$titled:this.$input},t)),OO.ui.mixin.AccessKeyedElement.call(this,$.extend({$accessKeyed:this.$input},t)),this.$input.on("keydown mouseup cut paste change input select",this.onEdit.bind(this)),this.$input.addClass("oo-ui-inputWidget-input").attr("name",t.name).prop("disabled",this.isDisabled()),this.$element.addClass("oo-ui-inputWidget").append(this.$input),this.setValue(t.value),t.dir&&this.setDir(t.dir),void 0!==t.inputId&&this.setInputId(t.inputId)},OO.inheritClass(OO.ui.InputWidget,OO.ui.Widget),OO.mixinClass(OO.ui.InputWidget,OO.ui.mixin.TabIndexedElement),OO.mixinClass(OO.ui.InputWidget,OO.ui.mixin.TitledElement),OO.mixinClass(OO.ui.InputWidget,OO.ui.mixin.AccessKeyedElement),OO.ui.InputWidget.static.reusePreInfuseDOM=function(t,e){return(e=OO.ui.InputWidget.parent.static.reusePreInfuseDOM(t,e)).$input=$(t).find(".oo-ui-inputWidget-input"),e},OO.ui.InputWidget.static.gatherPreInfuseState=function(t,e){var i=OO.ui.InputWidget.parent.static.gatherPreInfuseState(t,e);return e.$input&&e.$input.length&&(i.value=e.$input.val(),i.focus=e.$input.is(":focus")),i},OO.ui.InputWidget.prototype.getInputElement=function(){return $("<input>")},OO.ui.InputWidget.prototype.onEdit=function(){var t=this;this.isDisabled()||setTimeout(function(){t.setValue(t.$input.val())})},OO.ui.InputWidget.prototype.getValue=function(){var t=this.$input.val();return this.value!==t&&this.setValue(t),this.value},OO.ui.InputWidget.prototype.setDir=function(t){return this.$input.prop("dir",t),this},OO.ui.InputWidget.prototype.setValue=function(t){return t=this.cleanUpValue(t),this.$input.val()!==t&&this.$input.val(t),this.value!==t&&(this.value=t,this.emit("change",this.value)),void 0===this.defaultValue&&(this.defaultValue=this.value,this.$input[0].defaultValue=this.defaultValue),this},OO.ui.InputWidget.prototype.cleanUpValue=function(t){return null==t?"":this.inputFilter?this.inputFilter(String(t)):String(t)},OO.ui.InputWidget.prototype.setDisabled=function(t){return OO.ui.InputWidget.parent.prototype.setDisabled.call(this,t),this.$input&&this.$input.prop("disabled",this.isDisabled()),this},OO.ui.InputWidget.prototype.setInputId=function(t){return this.$input.attr("id",t),this},OO.ui.InputWidget.prototype.restorePreInfuseState=function(t){OO.ui.InputWidget.parent.prototype.restorePreInfuseState.call(this,t),void 0!==t.value&&t.value!==this.getValue()&&this.setValue(t.value),t.focus&&this.focus()},OO.ui.mixin.IconElement=function(t){t=t||{},this.$icon=null,this.icon=null,this.setIcon(t.icon||this.constructor.static.icon),this.setIconElement(t.$icon||$("<span>"))},OO.initClass(OO.ui.mixin.IconElement),OO.ui.mixin.IconElement.static.icon=null,OO.ui.mixin.IconElement.static.iconTitle=null,OO.ui.mixin.IconElement.prototype.setIconElement=function(t){this.$icon&&this.$icon.removeClass("oo-ui-iconElement-icon oo-ui-icon-"+this.icon).removeAttr("title"),this.$icon=t.addClass("oo-ui-iconElement-icon").toggleClass("oo-ui-iconElement-noIcon",!this.icon).toggleClass("oo-ui-icon-"+this.icon,!!this.icon),null!==this.iconTitle&&this.$icon.attr("title",this.iconTitle),this.updateThemeClasses()},OO.ui.mixin.IconElement.prototype.setIcon=function(t){return t="string"==typeof(t=OO.isPlainObject(t)?OO.ui.getLocalValue(t,null,"default"):t)&&t.trim().length?t.trim():null,this.icon!==t&&(this.$icon&&(null!==this.icon&&this.$icon.removeClass("oo-ui-icon-"+this.icon),null!==t&&this.$icon.addClass("oo-ui-icon-"+t)),this.icon=t),this.$element.toggleClass("oo-ui-iconElement",!!this.icon),this.$icon&&this.$icon.toggleClass("oo-ui-iconElement-noIcon",!this.icon),this.updateThemeClasses(),this},OO.ui.mixin.IconElement.prototype.getIcon=function(){return this.icon},OO.ui.mixin.IconElement.prototype.getIconTitle=function(){return this.iconTitle},OO.ui.mixin.IndicatorElement=function(t){t=t||{},this.$indicator=null,this.indicator=null,this.setIndicator(t.indicator||this.constructor.static.indicator),this.setIndicatorElement(t.$indicator||$("<span>"))},OO.initClass(OO.ui.mixin.IndicatorElement),OO.ui.mixin.IndicatorElement.static.indicator=null,OO.ui.mixin.IndicatorElement.static.indicatorTitle=null,OO.ui.mixin.IndicatorElement.prototype.setIndicatorElement=function(t){this.$indicator&&this.$indicator.removeClass("oo-ui-indicatorElement-indicator oo-ui-indicator-"+this.indicator).removeAttr("title"),this.$indicator=t.addClass("oo-ui-indicatorElement-indicator").toggleClass("oo-ui-indicatorElement-noIndicator",!this.indicator).toggleClass("oo-ui-indicator-"+this.indicator,!!this.indicator),null!==this.indicatorTitle&&this.$indicator.attr("title",this.indicatorTitle),this.updateThemeClasses()},OO.ui.mixin.IndicatorElement.prototype.setIndicator=function(t){return t="string"==typeof t&&t.length?t.trim():null,this.indicator!==t&&(this.$indicator&&(null!==this.indicator&&this.$indicator.removeClass("oo-ui-indicator-"+this.indicator),null!==t&&this.$indicator.addClass("oo-ui-indicator-"+t)),this.indicator=t),this.$element.toggleClass("oo-ui-indicatorElement",!!this.indicator),this.$indicator&&this.$indicator.toggleClass("oo-ui-indicatorElement-noIndicator",!this.indicator),this.updateThemeClasses(),this},OO.ui.mixin.IndicatorElement.prototype.getIndicator=function(){return this.indicator},OO.ui.mixin.IndicatorElement.prototype.getIndicatorTitle=function(){return this.indicatorTitle},OO.ui.mixin.PendingElement=function(t){t=t||{},this.pending=0,this.$pending=null,this.setPendingElement(t.$pending||this.$element)},OO.initClass(OO.ui.mixin.PendingElement),OO.ui.mixin.PendingElement.prototype.setPendingElement=function(t){this.$pending&&this.$pending.removeClass("oo-ui-pendingElement-pending"),this.$pending=t,0<this.pending&&this.$pending.addClass("oo-ui-pendingElement-pending")},OO.ui.mixin.PendingElement.prototype.isPending=function(){return!!this.pending},OO.ui.mixin.PendingElement.prototype.pushPending=function(){return 0===this.pending&&(this.$pending.addClass("oo-ui-pendingElement-pending"),this.updateThemeClasses()),this.pending++,this},OO.ui.mixin.PendingElement.prototype.popPending=function(){return 1===this.pending&&(this.$pending.removeClass("oo-ui-pendingElement-pending"),this.updateThemeClasses()),this.pending=Math.max(0,this.pending-1),this},OO.ui.mixin.LabelElement=function(t){t=t||{},this.$label=null,this.label=null,this.invisibleLabel=null,this.setLabel(t.label||this.constructor.static.label),this.setLabelElement(t.$label||$("<span>")),this.setInvisibleLabel(t.invisibleLabel)},OO.initClass(OO.ui.mixin.LabelElement),OO.ui.mixin.LabelElement.static.label=null,OO.ui.mixin.LabelElement.static.highlightQuery=function(t,e,i){var n,o,s,r=-1,l=$("<span>");if(i)for(o=t.length,s=e.length,n=0;-1===r&&n<=o-s;n++)0===i(e,t.slice(n,n+s))&&(r=n);else r=t.toLowerCase().indexOf(e.toLowerCase());return e.length&&-1!==r?l.append(document.createTextNode(t.slice(0,r)),$("<span>").addClass("oo-ui-labelElement-label-highlight").text(t.slice(r,r+e.length)),document.createTextNode(t.slice(r+e.length))):l.text(t),l.contents()},OO.ui.mixin.LabelElement.prototype.setLabelElement=function(t){this.$label&&this.$label.removeClass("oo-ui-labelElement-label").empty(),this.$label=t.addClass("oo-ui-labelElement-label"),this.setLabelContent(this.label)},OO.ui.mixin.LabelElement.prototype.setLabel=function(t){return t=("string"==typeof(t="function"==typeof t?OO.ui.resolveMsg(t):t)||t instanceof $)&&t.length||t instanceof OO.ui.HtmlSnippet&&t.toString().length?t:null,this.label!==t&&(this.$label&&this.setLabelContent(t),this.label=t,this.emit("labelChange")),this.$element.toggleClass("oo-ui-labelElement",!!this.label&&!this.invisibleLabel),this},OO.ui.mixin.LabelElement.prototype.setInvisibleLabel=function(t){return t=!!t,this.invisibleLabel!==t&&(this.invisibleLabel=t,this.emit("labelChange")),this.$label.toggleClass("oo-ui-labelElement-invisible",this.invisibleLabel),this.$element.toggleClass("oo-ui-labelElement",!!this.label&&!this.invisibleLabel),this},OO.ui.mixin.LabelElement.prototype.setHighlightedQuery=function(t,e,i){return this.setLabel(this.constructor.static.highlightQuery(t,e,i))},OO.ui.mixin.LabelElement.prototype.getLabel=function(){return this.label},OO.ui.mixin.LabelElement.prototype.setLabelContent=function(t){"string"==typeof t?t.match(/^\s*$/)?this.$label.html("&nbsp;"):this.$label.text(t):t instanceof OO.ui.HtmlSnippet?this.$label.html(t.toString()):t instanceof $?this.$label.empty().append(t):this.$label.empty()},OO.ui.TextInputWidget=function(t){t=$.extend({type:"text",labelPosition:"after"},t),OO.ui.TextInputWidget.parent.call(this,t),OO.ui.mixin.IconElement.call(this,t),OO.ui.mixin.IndicatorElement.call(this,t),OO.ui.mixin.PendingElement.call(this,$.extend({$pending:this.$input},t)),OO.ui.mixin.LabelElement.call(this,t),OO.ui.mixin.FlaggedElement.call(this,t),this.type=this.getSaneType(t),this.readOnly=!1,this.required=!1,this.validate=null,this.scrollWidth=null,this.setValidation(t.validate),this.setLabelPosition(t.labelPosition),this.$input.on({keypress:this.onKeyPress.bind(this),blur:this.onBlur.bind(this),focus:this.onFocus.bind(this)}),this.$icon.on("mousedown",this.onIconMouseDown.bind(this)),this.$indicator.on("mousedown",this.onIndicatorMouseDown.bind(this)),this.on("labelChange",this.updatePosition.bind(this)),this.on("change",OO.ui.debounce(this.onDebouncedChange.bind(this),250)),this.$element.addClass("oo-ui-textInputWidget oo-ui-textInputWidget-type-"+this.type).append(this.$icon,this.$indicator),this.setReadOnly(!!t.readOnly),this.setRequired(!!t.required),void 0!==t.placeholder&&this.$input.attr("placeholder",t.placeholder),void 0!==t.maxLength&&this.$input.attr("maxlength",t.maxLength),t.autofocus&&this.$input.attr("autofocus","autofocus"),!1===t.autocomplete&&(this.$input.attr("autocomplete","off"),$(window).on({beforeunload:function(){this.$input.removeAttr("autocomplete")}.bind(this),pageshow:function(){this.$input.attr("autocomplete","off")}.bind(this)})),void 0!==t.spellcheck&&this.$input.attr("spellcheck",t.spellcheck?"true":"false"),this.label&&(this.isWaitingToBeAttached=!0,this.installParentChangeDetector())},OO.inheritClass(OO.ui.TextInputWidget,OO.ui.InputWidget),OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.IconElement),OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.IndicatorElement),OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.PendingElement),OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.LabelElement),OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.FlaggedElement),OO.ui.TextInputWidget.static.validationPatterns={"non-empty":/.+/,integer:/^\d+$/},OO.ui.TextInputWidget.prototype.onIconMouseDown=function(t){if(t.which===OO.ui.MouseButtons.LEFT)return this.focus(),!1},OO.ui.TextInputWidget.prototype.onIndicatorMouseDown=function(t){if(t.which===OO.ui.MouseButtons.LEFT)return this.focus(),!1},OO.ui.TextInputWidget.prototype.onKeyPress=function(t){t.which===OO.ui.Keys.ENTER&&this.emit("enter",t)},OO.ui.TextInputWidget.prototype.onBlur=function(){this.setValidityFlag()},OO.ui.TextInputWidget.prototype.onFocus=function(){this.isWaitingToBeAttached&&this.onElementAttach(),this.setValidityFlag(!0)},OO.ui.TextInputWidget.prototype.onElementAttach=function(){this.isWaitingToBeAttached=!1,this.valCache=null,this.positionLabel()},OO.ui.TextInputWidget.prototype.onDebouncedChange=function(){this.setValidityFlag()},OO.ui.TextInputWidget.prototype.isReadOnly=function(){return this.readOnly},OO.ui.TextInputWidget.prototype.setReadOnly=function(t){return this.readOnly=!!t,this.$input.prop("readOnly",this.readOnly),this},OO.ui.TextInputWidget.prototype.isRequired=function(){return this.required},OO.ui.TextInputWidget.prototype.setRequired=function(t){return this.required=!!t,this.required?(this.$input.prop("required",!0).attr("aria-required","true"),null===this.getIndicator()&&this.setIndicator("required")):(this.$input.prop("required",!1).removeAttr("aria-required"),"required"===this.getIndicator()&&this.setIndicator(null)),this},OO.ui.TextInputWidget.prototype.installParentChangeDetector=function(){var t,o,s,e,i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,n=this;if(i){if(this.isElementAttached())return;for(s=this.$element[0];s.parentNode;)s=s.parentNode;t=new i(function(t){var e,i,n;for(e=0;e<t.length;e++)for(n=t[e].removedNodes,i=0;i<n.length;i++)if(n[i]===s)return void setTimeout(o,0)}),o=function(){n.isElementAttached()&&n.onElementAttach(),t.disconnect(),n.installParentChangeDetector()},e=$("<div>").append(s)[0],t.observe(e,{childList:!0})}else this.$element.on("DOMNodeInsertedIntoDocument",this.onElementAttach.bind(this))},OO.ui.TextInputWidget.prototype.getInputElement=function(t){return"number"===this.getSaneType(t)?$("<input>").attr("step","any").attr("type","number"):$("<input>").attr("type",this.getSaneType(t))},OO.ui.TextInputWidget.prototype.getSaneType=function(t){return-1!==["text","password","email","url","number"].indexOf(t.type)?t.type:"text"},OO.ui.TextInputWidget.prototype.selectRange=function(t,e){var i,n,o,s=this.$input[0];n=(i=(e=e||t)<t)?e:t,o=i?t:e,this.focus();try{s.setSelectionRange(n,o,i?"backward":"forward")}catch(t){if(this.getElementDocument().body.contains(s))throw t}return this},OO.ui.TextInputWidget.prototype.getRange=function(){var t=this.$input[0],e=t.selectionStart,i=t.selectionEnd,n="backward"===t.selectionDirection;return{from:n?i:e,to:n?e:i}},OO.ui.TextInputWidget.prototype.getInputLength=function(){return this.$input[0].value.length},OO.ui.TextInputWidget.prototype.select=function(){return this.selectRange(0,this.getInputLength())},OO.ui.TextInputWidget.prototype.moveCursorToStart=function(){return this.selectRange(0)},OO.ui.TextInputWidget.prototype.moveCursorToEnd=function(){return this.selectRange(this.getInputLength())},OO.ui.TextInputWidget.prototype.insertContent=function(t){var e,i,n=this.getRange(),o=this.getValue();return e=Math.min(n.from,n.to),i=Math.max(n.from,n.to),this.setValue(o.slice(0,e)+t+o.slice(i)),this.selectRange(e+t.length),this},OO.ui.TextInputWidget.prototype.encapsulateContent=function(t,e){var i,n,o=this.getRange(),s=t.length;return i=Math.min(o.from,o.to),n=Math.max(o.from,o.to),this.selectRange(i).insertContent(t),this.selectRange(s+n).insertContent(e),this.selectRange(s+i,s+n),this},OO.ui.TextInputWidget.prototype.setValidation=function(t){t instanceof RegExp||t instanceof Function?this.validate=t:this.validate=this.constructor.static.validationPatterns[t]||/.*/},OO.ui.TextInputWidget.prototype.setValidityFlag=function(t){var e=this,i=function(t){t?e.$input.removeAttr("aria-invalid"):e.$input.attr("aria-invalid","true"),e.setFlags({invalid:!t})};void 0!==t?i(t):this.getValidity().then(function(){i(!0)},function(){i(!1)})},OO.ui.TextInputWidget.prototype.getValidity=function(){var t;function e(t){return t?$.Deferred().resolve().promise():$.Deferred().reject().promise()}return void 0!==this.$input[0].checkValidity&&!1===this.$input[0].checkValidity()?e(!1):this.validate instanceof Function?(t=this.validate(this.getValue()))&&"function"==typeof t.promise?t.promise().then(function(t){return e(t)}):e(t):e(this.getValue().match(this.validate))},OO.ui.TextInputWidget.prototype.setLabelPosition=function(t){return this.labelPosition=t,this.label&&this.updatePosition(),this},OO.ui.TextInputWidget.prototype.updatePosition=function(){var t="after"===this.labelPosition;return this.$element.toggleClass("oo-ui-textInputWidget-labelPosition-after",!!this.label&&t).toggleClass("oo-ui-textInputWidget-labelPosition-before",!!this.label&&!t),this.valCache=null,this.scrollWidth=null,this.positionLabel(),this},OO.ui.TextInputWidget.prototype.positionLabel=function(){var t,e;return this.isWaitingToBeAttached?this:(e={"padding-right":"","padding-left":""},this.label?(this.$element.append(this.$label),e[(t="after"===this.labelPosition)===("rtl"===this.$element.css("direction"))?"padding-left":"padding-right"]=this.$label.outerWidth(!0)+(t?this.scrollWidth:0),this.$input.css(e),this):(this.$label.detach(),void this.$input.css(e)))},OO.ui.IconWidget=function(t){t=t||{},OO.ui.IconWidget.parent.call(this,t),OO.ui.mixin.IconElement.call(this,$.extend({$icon:this.$element},t)),OO.ui.mixin.TitledElement.call(this,$.extend({$titled:this.$element},t)),OO.ui.mixin.LabelElement.call(this,$.extend({$label:this.$element,invisibleLabel:!0},t)),OO.ui.mixin.FlaggedElement.call(this,$.extend({$flagged:this.$element},t)),this.$element.addClass("oo-ui-iconWidget"),this.$element.removeClass("oo-ui-labelElement-label")},OO.inheritClass(OO.ui.IconWidget,OO.ui.Widget),OO.mixinClass(OO.ui.IconWidget,OO.ui.mixin.IconElement),OO.mixinClass(OO.ui.IconWidget,OO.ui.mixin.TitledElement),OO.mixinClass(OO.ui.IconWidget,OO.ui.mixin.LabelElement),OO.mixinClass(OO.ui.IconWidget,OO.ui.mixin.FlaggedElement),OO.ui.IconWidget.static.tagName="span",OO.ui.mixin.GroupElement=function(t){t=t||{},OO.EmitterList.call(this,t),this.$group=null,this.setGroupElement(t.$group||$("<div>"))},OO.mixinClass(OO.ui.mixin.GroupElement,OO.EmitterList),OO.ui.mixin.GroupElement.prototype.setGroupElement=function(t){var e,i;for(this.$group=t,e=0,i=this.items.length;e<i;e++)this.$group.append(this.items[e].$element)},OO.ui.mixin.GroupElement.prototype.findItemFromData=function(t){var e,i,n,o=OO.getHash(t);for(e=0,i=this.items.length;e<i;e++)if(n=this.items[e],o===OO.getHash(n.getData()))return n;return null},OO.ui.mixin.GroupElement.prototype.findItemsFromData=function(t){var e,i,n,o=OO.getHash(t),s=[];for(e=0,i=this.items.length;e<i;e++)n=this.items[e],o===OO.getHash(n.getData())&&s.push(n);return s},OO.ui.mixin.GroupElement.prototype.addItems=function(t,e){return 0===t.length||(OO.EmitterList.prototype.addItems.call(this,t,e),this.emit("change",this.getItems())),this},OO.ui.mixin.GroupElement.prototype.moveItem=function(t,e){return this.insertItemElements(t,e),e=OO.EmitterList.prototype.moveItem.call(this,t,e)},OO.ui.mixin.GroupElement.prototype.insertItem=function(t,e){return t.setElementGroup(this),this.insertItemElements(t,e),e=OO.EmitterList.prototype.insertItem.call(this,t,e)},OO.ui.mixin.GroupElement.prototype.insertItemElements=function(t,e){void 0===e||e<0||e>=this.items.length?this.$group.append(t.$element):0===e?this.$group.prepend(t.$element):this.items[e].$element.before(t.$element)},OO.ui.mixin.GroupElement.prototype.removeItems=function(t){var e,i,n;if(0===t.length)return this;for(e=0,i=t.length;e<i;e++)n=t[e],-1!==this.items.indexOf(n)&&(n.setElementGroup(null),n.$element.detach());return OO.EmitterList.prototype.removeItems.call(this,t),this.emit("change",this.getItems()),this},OO.ui.mixin.GroupElement.prototype.clearItems=function(){var t,e;for(t=0,e=this.items.length;t<e;t++)this.items[t].setElementGroup(null),this.items[t].$element.detach();return OO.EmitterList.prototype.clearItems.call(this),this.emit("change",this.getItems()),this},OO.ui.mixin.GroupWidget=function(t){OO.ui.mixin.GroupElement.call(this,t)},OO.mixinClass(OO.ui.mixin.GroupWidget,OO.ui.mixin.GroupElement),OO.ui.mixin.GroupWidget.prototype.setDisabled=function(t){var e,i;if(OO.ui.Widget.prototype.setDisabled.call(this,t),this.items)for(e=0,i=this.items.length;e<i;e++)this.items[e].updateDisabled();return this},OO.ui.SelectWidget=function(t){t=t||{},OO.ui.SelectWidget.parent.call(this,t),OO.ui.mixin.GroupWidget.call(this,$.extend({$group:this.$element},t)),this.pressed=!1,this.selecting=null,this.multiselect=!!t.multiselect,this.onDocumentMouseUpHandler=this.onDocumentMouseUp.bind(this),this.onDocumentMouseMoveHandler=this.onDocumentMouseMove.bind(this),this.onDocumentKeyDownHandler=this.onDocumentKeyDown.bind(this),this.onDocumentKeyPressHandler=this.onDocumentKeyPress.bind(this),this.keyPressBuffer="",this.keyPressBufferTimer=null,this.blockMouseOverEvents=0,this.connect(this,{toggle:"onToggle"}),this.$element.on({focusin:this.onFocus.bind(this),mousedown:this.onMouseDown.bind(this),mouseover:this.onMouseOver.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.$element.addClass("oo-ui-selectWidget oo-ui-selectWidget-unpressed").attr("role","listbox"),this.setFocusOwner(this.$element),Array.isArray(t.items)&&this.addItems(t.items)},OO.inheritClass(OO.ui.SelectWidget,OO.ui.Widget),OO.mixinClass(OO.ui.SelectWidget,OO.ui.mixin.GroupWidget),OO.ui.SelectWidget.static.normalizeForMatching=function(t){var e=t.trim().replace(/\s+/," ").toLowerCase();return e.normalize&&(e=e.normalize()),e},OO.ui.SelectWidget.prototype.onFocus=function(t){var e;if(t.target===this.$element[0])this.findSelectedItem()||(e=this.findFirstSelectableItem());else{if(-1!==t.target.tabIndex)return;e=this.findTargetItem(t)}e&&(e.constructor.static.highlightable?this.highlightItem(e):this.selectItem(e)),t.target!==this.$element[0]&&this.$focusOwner.trigger("focus")},OO.ui.SelectWidget.prototype.onMouseDown=function(t){var e;return this.isDisabled()||t.which!==OO.ui.MouseButtons.LEFT||(this.togglePressed(!0),(e=this.findTargetItem(t))&&e.isSelectable()&&(this.pressItem(e),this.selecting=e,this.getElementDocument().addEventListener("mouseup",this.onDocumentMouseUpHandler,!0),this.getElementDocument().addEventListener("mousemove",this.onDocumentMouseMoveHandler,!0))),!1},OO.ui.SelectWidget.prototype.onDocumentMouseUp=function(t){var e;return this.togglePressed(!1),this.selecting||(e=this.findTargetItem(t))&&e.isSelectable()&&(this.selecting=e),!this.isDisabled()&&t.which===OO.ui.MouseButtons.LEFT&&this.selecting&&(this.pressItem(null),this.chooseItem(this.selecting),this.selecting=null),this.getElementDocument().removeEventListener("mouseup",this.onDocumentMouseUpHandler,!0),this.getElementDocument().removeEventListener("mousemove",this.onDocumentMouseMoveHandler,!0),!1},OO.ui.SelectWidget.prototype.onDocumentMouseMove=function(t){var e;!this.isDisabled()&&this.pressed&&(e=this.findTargetItem(t))&&e!==this.selecting&&e.isSelectable()&&(this.pressItem(e),this.selecting=e)},OO.ui.SelectWidget.prototype.onMouseOver=function(t){var e;if(!this.blockMouseOverEvents)return this.isDisabled()||(e=this.findTargetItem(t),this.highlightItem(e&&e.isHighlightable()?e:null)),!1},OO.ui.SelectWidget.prototype.onMouseLeave=function(){return this.isDisabled()||this.highlightItem(null),!1},OO.ui.SelectWidget.prototype.onDocumentKeyDown=function(t){var e,i=!1,n=this.findSelectedItems(),o=this.findHighlightedItem()||(Array.isArray(n)?n[0]:n),s=this.getItems()[0];if(!this.isDisabled()&&this.isVisible()){switch(t.keyCode){case OO.ui.Keys.ENTER:o&&(this.chooseItem(o),i=!0);break;case OO.ui.Keys.UP:case OO.ui.Keys.LEFT:this.clearKeyPressBuffer(),e=o?this.findRelativeSelectableItem(o,-1):s,i=!0;break;case OO.ui.Keys.DOWN:case OO.ui.Keys.RIGHT:this.clearKeyPressBuffer(),e=o?this.findRelativeSelectableItem(o,1):s,i=!0;break;case OO.ui.Keys.ESCAPE:case OO.ui.Keys.TAB:o&&o.setHighlighted(!1),this.unbindDocumentKeyDownListener(),this.unbindDocumentKeyPressListener(),i=!1}e&&(e.constructor.static.highlightable?this.highlightItem(e):this.chooseItem(e),this.scrollItemIntoView(e)),i&&(t.preventDefault(),t.stopPropagation())}},OO.ui.SelectWidget.prototype.bindDocumentKeyDownListener=function(){this.getElementDocument().addEventListener("keydown",this.onDocumentKeyDownHandler,!0)},OO.ui.SelectWidget.prototype.unbindDocumentKeyDownListener=function(){this.getElementDocument().removeEventListener("keydown",this.onDocumentKeyDownHandler,!0)},OO.ui.SelectWidget.prototype.scrollItemIntoView=function(t){var e=this;this.blockMouseOverEvents++,t.scrollElementIntoView().done(function(){setTimeout(function(){e.blockMouseOverEvents--},200)})},OO.ui.SelectWidget.prototype.clearKeyPressBuffer=function(){this.keyPressBufferTimer&&(clearTimeout(this.keyPressBufferTimer),this.keyPressBufferTimer=null),this.keyPressBuffer=""},OO.ui.SelectWidget.prototype.onDocumentKeyPress=function(t){var e,i,n,o;if(!t.charCode)return t.keyCode===OO.ui.Keys.BACKSPACE&&""!==this.keyPressBuffer?(this.keyPressBuffer=this.keyPressBuffer.substr(0,this.keyPressBuffer.length-1),!1):void 0;e=String.fromCodePoint?String.fromCodePoint(t.charCode):String.fromCharCode(t.charCode),this.keyPressBufferTimer&&clearTimeout(this.keyPressBufferTimer),this.keyPressBufferTimer=setTimeout(this.clearKeyPressBuffer.bind(this),1500),o=this.findSelectedItems(),n=this.findHighlightedItem()||(Array.isArray(o)?o[0]:o),this.keyPressBuffer===e?n&&(n=this.findRelativeSelectableItem(n,1)):this.keyPressBuffer+=e,i=this.getItemMatcher(this.keyPressBuffer,!1),n&&i(n)||(n=this.findRelativeSelectableItem(n,1,i)),n&&(this.isVisible()&&n.constructor.static.highlightable?this.highlightItem(n):this.chooseItem(n),this.scrollItemIntoView(n)),t.preventDefault(),t.stopPropagation()},OO.ui.SelectWidget.prototype.getItemMatcher=function(t,i){var n=this.constructor.static.normalizeForMatching,o=n(t);return!0===i&&(i="exact"),function(t){var e=n(t.getMatchText());if(""===o)return"exact"!==i;switch(i){case"exact":return e===o;case"substring":return-1!==e.indexOf(o);default:return 0===e.indexOf(o)}}},OO.ui.SelectWidget.prototype.bindDocumentKeyPressListener=function(){this.getElementDocument().addEventListener("keypress",this.onDocumentKeyPressHandler,!0)},OO.ui.SelectWidget.prototype.unbindDocumentKeyPressListener=function(){this.getElementDocument().removeEventListener("keypress",this.onDocumentKeyPressHandler,!0),this.clearKeyPressBuffer()},OO.ui.SelectWidget.prototype.onToggle=function(t){t||this.clearKeyPressBuffer()},OO.ui.SelectWidget.prototype.findTargetItem=function(t){var e=$(t.target).closest(".oo-ui-optionWidget");return e.closest(".oo-ui-selectWidget").is(this.$element)&&e.data("oo-ui-optionWidget")||null},OO.ui.SelectWidget.prototype.findSelectedItems=function(){var t=this.items.filter(function(t){return t.isSelected()});return this.multiselect?t:t[0]||null},OO.ui.SelectWidget.prototype.findSelectedItem=function(){return this.findSelectedItems()},OO.ui.SelectWidget.prototype.findHighlightedItem=function(){var t,e;for(t=0,e=this.items.length;t<e;t++)if(this.items[t].isHighlighted())return this.items[t];return null},OO.ui.SelectWidget.prototype.togglePressed=function(t){void 0===t&&(t=!this.pressed),t!==this.pressed&&(this.$element.toggleClass("oo-ui-selectWidget-pressed",t).toggleClass("oo-ui-selectWidget-unpressed",!t),this.pressed=t)},OO.ui.SelectWidget.prototype.highlightItem=function(t){var e,i,n,o=!1;for(e=0,i=this.items.length;e<i;e++)n=this.items[e]===t,this.items[e].isHighlighted()!==n&&(this.items[e].setHighlighted(n),o=!0);return o&&(t?this.$focusOwner.attr("aria-activedescendant",t.getElementId()):this.$focusOwner.removeAttr("aria-activedescendant"),this.emit("highlight",t)),this},OO.ui.SelectWidget.prototype.getItemFromLabel=function(t,e){var i,n,o,s=this.items.length,r=this.getItemMatcher(t,"exact");for(i=0;i<s;i++)if((n=this.items[i])instanceof OO.ui.OptionWidget&&n.isSelectable()&&r(n))return n;if(e){for(o=null,r=this.getItemMatcher(t,"prefix"),i=0;i<s;i++)if((n=this.items[i])instanceof OO.ui.OptionWidget&&n.isSelectable()&&r(n)){if(o)return null;o=n}if(o)return o}return null},OO.ui.SelectWidget.prototype.selectItemByLabel=function(t,e){var i=this.getItemFromLabel(t,!!e);return void 0!==t&&i?this.selectItem(i):this.selectItem()},OO.ui.SelectWidget.prototype.selectItemByData=function(t){var e=this.findItemFromData(t);return void 0!==t&&e?this.selectItem(e):this.selectItem()},OO.ui.SelectWidget.prototype.unselectItem=function(t){return t?t.setSelected(!1):this.items.forEach(function(t){t.setSelected(!1)}),this.emit("select",this.findSelectedItems()),this},OO.ui.SelectWidget.prototype.selectItem=function(t){var e,i,n,o=!1;if(this.multiselect&&t)t.setSelected(!0);else for(e=0,i=this.items.length;e<i;e++)n=this.items[e]===t,this.items[e].isSelected()!==n&&(this.items[e].setSelected(n),o=!0);return o&&(t&&!t.constructor.static.highlightable&&(t?this.$focusOwner.attr("aria-activedescendant",t.getElementId()):this.$focusOwner.removeAttr("aria-activedescendant")),this.emit("select",this.findSelectedItems())),this},OO.ui.SelectWidget.prototype.pressItem=function(t){var e,i,n,o=!1;for(e=0,i=this.items.length;e<i;e++)n=this.items[e]===t,this.items[e].isPressed()!==n&&(this.items[e].setPressed(n),o=!0);return o&&this.emit("press",t),this},OO.ui.SelectWidget.prototype.chooseItem=function(t){return t&&(this.multiselect&&t.isSelected()?this.unselectItem(t):this.selectItem(t),this.emit("choose",t,t.isSelected())),this},OO.ui.SelectWidget.prototype.findRelativeSelectableItem=function(t,e,i){var n,o,s=0<e?1:-1,r=this.items.length;for(n=t instanceof OO.ui.OptionWidget?(this.items.indexOf(t)+s+r)%r:0<e?0:r-1,o=0;o<r;o++){if((t=this.items[n])instanceof OO.ui.OptionWidget&&t.isSelectable()&&(!i||i(t)))return t;n=(n+s+r)%r}return null},OO.ui.SelectWidget.prototype.findFirstSelectableItem=function(){return this.findRelativeSelectableItem(null,1)},OO.ui.SelectWidget.prototype.addItems=function(t,e){return OO.ui.mixin.GroupWidget.prototype.addItems.call(this,t,e),this.emit("add",t,void 0===e?this.items.length-t.length-1:e),this},OO.ui.SelectWidget.prototype.removeItems=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].isSelected()&&this.selectItem(null);return OO.ui.mixin.GroupWidget.prototype.removeItems.call(this,t),this.emit("remove",t),this},OO.ui.SelectWidget.prototype.clearItems=function(){var t=this.items.slice();return OO.ui.mixin.GroupWidget.prototype.clearItems.call(this),this.selectItem(null),this.emit("remove",t),this},OO.ui.SelectWidget.prototype.setFocusOwner=function(t){this.$focusOwner=t},OO.ui.mixin.ClippableElement=function(t){t=t||{},this.$clippable=null,this.$clippableContainer=null,this.clipping=!1,this.clippedHorizontally=!1,this.clippedVertically=!1,this.$clippableScrollableContainer=null,this.$clippableScroller=null,this.$clippableWindow=null,this.idealWidth=null,this.idealHeight=null,this.onClippableScrollHandler=this.clip.bind(this),this.onClippableWindowResizeHandler=this.clip.bind(this),t.$clippableContainer&&this.setClippableContainer(t.$clippableContainer),this.setClippableElement(t.$clippable||this.$element)},OO.ui.mixin.ClippableElement.prototype.setClippableElement=function(t){this.$clippable&&(this.$clippable.removeClass("oo-ui-clippableElement-clippable"),this.$clippable.css({width:"",height:"",overflowX:"",overflowY:""}),OO.ui.Element.static.reconsiderScrollbars(this.$clippable[0])),this.$clippable=t.addClass("oo-ui-clippableElement-clippable"),this.clip()},OO.ui.mixin.ClippableElement.prototype.setClippableContainer=function(t){this.$clippableContainer=t,this.$clippable&&this.clip()},OO.ui.mixin.ClippableElement.prototype.toggleClipping=function(t){return!(t=void 0===t?!this.clipping:!!t)||this.warnedUnattached||this.isElementAttached()||(OO.ui.warnDeprecation("ClippableElement#toggleClipping: Before calling this method, the element must be attached to the DOM."),this.warnedUnattached=!0),this.clipping!==t&&((this.clipping=t)?(this.$clippableScrollableContainer=$(this.getClosestScrollableElementContainer()),this.$clippableScroller=this.$clippableScrollableContainer.is("html, body")?$(OO.ui.Element.static.getWindow(this.$clippableScrollableContainer)):this.$clippableScrollableContainer,this.$clippableScroller.on("scroll",this.onClippableScrollHandler),this.$clippableWindow=$(this.getElementWindow()).on("resize",this.onClippableWindowResizeHandler),this.clip()):(this.$clippable.css({width:"",height:"",maxWidth:"",maxHeight:"",overflowX:"",overflowY:""}),OO.ui.Element.static.reconsiderScrollbars(this.$clippable[0]),this.$clippableScrollableContainer=null,this.$clippableScroller.off("scroll",this.onClippableScrollHandler),this.$clippableScroller=null,this.$clippableWindow.off("resize",this.onClippableWindowResizeHandler),this.$clippableWindow=null)),this},OO.ui.mixin.ClippableElement.prototype.isClipping=function(){return this.clipping},OO.ui.mixin.ClippableElement.prototype.isClipped=function(){return this.clippedHorizontally||this.clippedVertically},OO.ui.mixin.ClippableElement.prototype.isClippedHorizontally=function(){return this.clippedHorizontally},OO.ui.mixin.ClippableElement.prototype.isClippedVertically=function(){return this.clippedVertically},OO.ui.mixin.ClippableElement.prototype.setIdealSize=function(t,e){this.idealWidth=t,this.idealHeight=e,this.clipping||this.$clippable.css({width:t,height:e})},OO.ui.mixin.ClippableElement.prototype.getHorizontalAnchorEdge=function(){return this.computePosition&&this.positioning&&""!==this.computePosition().right?"right":"left"},OO.ui.mixin.ClippableElement.prototype.getVerticalAnchorEdge=function(){return this.computePosition&&this.positioning&&""!==this.computePosition().bottom?"bottom":"top"},OO.ui.mixin.ClippableElement.prototype.clip=function(){var t,e,i,n,o,s,r,l,a,u,c,h,p,d,m,g,f,O,y,b,w;if(!this.clipping)return this;return i=OO.ui.getViewportSpacing(),this.$clippableScrollableContainer.is("html, body")?(p=$(this.$clippableScrollableContainer[0].ownerDocument.body),(d={top:0,left:0,right:document.documentElement.clientWidth,bottom:document.documentElement.clientHeight}).top+=i.top,d.left+=i.left,d.right-=i.right,d.bottom-=i.bottom):(d=(p=this.$clippableScrollableContainer)[0].getBoundingClientRect(),d=$.extend({},d)),g=p.css("direction"),f=p.innerWidth()-p.prop("clientWidth"),O=p.innerHeight()-p.prop("clientHeight"),d.bottom-=O,"rtl"===g?d.left+=f:d.right-=f,d.top+=7,d.left+=7,d.right-=7,d.bottom-=7,t=(c=this.$clippableContainer||this.$clippable).outerHeight()-this.$clippable.outerHeight(),e=c.outerWidth()-this.$clippable.outerWidth(),h=c[0].getBoundingClientRect(),h=$.extend({},h),"right"===this.getHorizontalAnchorEdge()?h.left=d.left:h.right=d.right,"bottom"===this.getVerticalAnchorEdge()?h.top=d.top:h.bottom=d.bottom,y=d,b=h,(w={}).top=Math.max(y.top,b.top),w.left=Math.max(y.left,b.left),w.bottom=Math.min(y.bottom,b.bottom),w.right=Math.min(y.right,b.right),m=w,n=Math.max(0,m.right-m.left),o=Math.max(0,m.bottom-m.top),n=Math.min(n,document.documentElement.clientWidth-i.left-i.right),o=Math.min(o,document.documentElement.clientHeight-i.top-i.right),s=Math.ceil(n-e),r=Math.ceil(o-t),l=this.$clippable.prop("scrollWidth"),u=r<this.$clippable.prop("scrollHeight"),(a=s<l)?(this.$clippable.css("overflowX","scroll"),this.$clippable[0].offsetHeight,this.$clippable.css({width:Math.max(0,s),maxWidth:""})):this.$clippable.css({overflowX:"",width:this.idealWidth||"",maxWidth:Math.max(0,s)}),u?(this.$clippable.css("overflowY","scroll"),this.$clippable[0].offsetHeight,this.$clippable.css({height:Math.max(0,r),maxHeight:""})):this.$clippable.css({overflowY:"",height:this.idealHeight||"",maxHeight:Math.max(0,r)}),(this.clippedHorizontally&&!a||this.clippedVertically&&!u)&&OO.ui.Element.static.reconsiderScrollbars(this.$clippable[0]),this.clippedHorizontally=a,this.clippedVertically=u,this},OO.ui.mixin.FloatableElement=function(t){t=t||{},this.$floatable=null,this.$floatableContainer=null,this.$floatableWindow=null,this.$floatableClosestScrollable=null,this.floatableOutOfView=!1,this.onFloatableScrollHandler=this.position.bind(this),this.onFloatableWindowResizeHandler=this.position.bind(this),this.setFloatableContainer(t.$floatableContainer),this.setFloatableElement(t.$floatable||this.$element),this.setVerticalPosition(t.verticalPosition||"below"),this.setHorizontalPosition(t.horizontalPosition||"start"),this.hideWhenOutOfView=void 0===t.hideWhenOutOfView||!!t.hideWhenOutOfView},OO.ui.mixin.FloatableElement.prototype.setFloatableElement=function(t){this.$floatable&&(this.$floatable.removeClass("oo-ui-floatableElement-floatable"),this.$floatable.css({left:"",top:""})),this.$floatable=t.addClass("oo-ui-floatableElement-floatable"),this.position()},OO.ui.mixin.FloatableElement.prototype.setFloatableContainer=function(t){this.$floatableContainer=t,this.$floatable&&this.position()},OO.ui.mixin.FloatableElement.prototype.setVerticalPosition=function(t){if(-1===["below","above","top","bottom","center"].indexOf(t))throw new Error("Invalid value for vertical position: "+t);this.verticalPosition!==t&&(this.verticalPosition=t,this.$floatable&&this.position())},OO.ui.mixin.FloatableElement.prototype.setHorizontalPosition=function(t){if(-1===["before","after","start","end","center"].indexOf(t))throw new Error("Invalid value for horizontal position: "+t);this.horizontalPosition!==t&&(this.horizontalPosition=t,this.$floatable&&this.position())},OO.ui.mixin.FloatableElement.prototype.togglePositioning=function(t){var e;return this.$floatable&&this.$floatableContainer&&(!(t=void 0===t?!this.positioning:!!t)||this.warnedUnattached||this.isElementAttached()||(OO.ui.warnDeprecation("FloatableElement#togglePositioning: Before calling this method, the element must be attached to the DOM."),this.warnedUnattached=!0),this.positioning!==t&&(this.positioning=t,e=OO.ui.Element.static.getClosestScrollableContainer(this.$floatableContainer[0]),$(e).is("html, body")&&(e=OO.ui.Element.static.getWindow(e)),t?(this.$floatableWindow=$(this.getElementWindow()),this.$floatableWindow.on("resize",this.onFloatableWindowResizeHandler),this.$floatableClosestScrollable=$(e),this.$floatableClosestScrollable.on("scroll",this.onFloatableScrollHandler),this.position()):(this.$floatableWindow&&(this.$floatableWindow.off("resize",this.onFloatableWindowResizeHandler),this.$floatableWindow=null),this.$floatableClosestScrollable&&(this.$floatableClosestScrollable.off("scroll",this.onFloatableScrollHandler),this.$floatableClosestScrollable=null),this.$floatable.css({left:"",right:"",top:""})))),this},OO.ui.mixin.FloatableElement.prototype.isElementInViewport=function(t,e){var i,n,o,s,r,l,a,u,c,h=t.css("direction");return i=t[0].getBoundingClientRect(),e[0]===window?(c=OO.ui.getViewportSpacing(),(n={top:0,left:0,right:document.documentElement.clientWidth,bottom:document.documentElement.clientHeight}).top+=c.top,n.left+=c.left,n.right-=c.right,n.bottom-=c.bottom):n=e[0].getBoundingClientRect(),o=i.top>=n.top&&i.top<=n.bottom,s=i.bottom>=n.top&&i.bottom<=n.bottom,r=i.left>=n.left&&i.left<=n.right,l=i.right>=n.left&&i.right<=n.right,u="rtl"===h?(a=l,r):(a=r,l),!("below"===this.verticalPosition&&!s)&&(!("above"===this.verticalPosition&&!o)&&(!("before"===this.horizontalPosition&&!a)&&(!("after"===this.horizontalPosition&&!u)&&(i.top<=n.bottom&&i.bottom>=n.top&&i.left<=n.right&&i.right>=n.left))))},OO.ui.mixin.FloatableElement.prototype.isFloatableOutOfView=function(){return this.floatableOutOfView},OO.ui.mixin.FloatableElement.prototype.position=function(){return this.positioning?!this.isElementAttached()||this.$floatableClosestScrollable[0]!==this.getElementWindow()&&!$.contains(this.getElementDocument(),this.$floatableClosestScrollable[0])?this:(this.floatableOutOfView=this.hideWhenOutOfView&&!this.isElementInViewport(this.$floatableContainer,this.$floatableClosestScrollable),this.floatableOutOfView?this.$floatable.addClass("oo-ui-element-hidden"):(this.$floatable.removeClass("oo-ui-element-hidden"),this.$floatable.css(this.computePosition()),this.clip&&this.clip()),this):this},OO.ui.mixin.FloatableElement.prototype.computePosition=function(){var t,e,i,n,o,s,r,l,a={top:"",left:"",bottom:"",right:""},u=this.$floatableContainer.css("direction"),c=this.$floatable.offsetParent();return c.is("html")&&(c=$(c[0].ownerDocument.body)),t=c.is("body"),e="scroll"===c.css("overflow-x")||"auto"===c.css("overflow-x"),i="scroll"===c.css("overflow-y")||"auto"===c.css("overflow-y"),s=c.innerWidth()-c.prop("clientWidth"),o=c.innerHeight()-c.prop("clientHeight"),r=i&&!t?c.scrollTop():0,l=e&&!t?OO.ui.Element.static.getScrollLeft(c[0]):0,(n=t?this.$floatableContainer.offset():OO.ui.Element.static.getRelativePosition(this.$floatableContainer,c)).bottom=n.top+this.$floatableContainer.outerHeight(),n.right=n.left+this.$floatableContainer.outerWidth(),n.start="rtl"===u?n.right:n.left,n.end="rtl"===u?n.left:n.right,"below"===this.verticalPosition?a.top=n.bottom:"above"===this.verticalPosition?a.bottom=c.outerHeight()-n.top:"top"===this.verticalPosition?a.top=n.top:"bottom"===this.verticalPosition?a.bottom=c.outerHeight()-n.bottom:"center"===this.verticalPosition&&(a.top=n.top+(this.$floatableContainer.height()-this.$floatable.height())/2),"before"===this.horizontalPosition?a.end=n.start:"after"===this.horizontalPosition?a.start=n.end:"start"===this.horizontalPosition?a.start=n.start:"end"===this.horizontalPosition?a.end=n.end:"center"===this.horizontalPosition&&(a.left=n.left+(this.$floatableContainer.width()-this.$floatable.width())/2),void 0!==a.start&&("rtl"===u?a.right=(t?$(c[0].ownerDocument.documentElement):c).outerWidth()-a.start:a.left=a.start,delete a.start),void 0!==a.end&&("rtl"===u?a.left=a.end:a.right=(t?$(c[0].ownerDocument.documentElement):c).outerWidth()-a.end,delete a.end),""!==a.top&&(a.top+=r),""!==a.bottom&&(a.bottom-=r),""!==a.left&&(a.left+=l),""!==a.right&&(a.right-=l),""!==a.bottom&&(a.bottom-=o),"rtl"===u?""!==a.left&&(a.left-=s):""!==a.right&&(a.right-=s),a},OO.ui.MenuSelectWidget=function(t){t=t||{},OO.ui.MenuSelectWidget.parent.call(this,t),OO.ui.mixin.ClippableElement.call(this,$.extend({$clippable:this.$group},t)),OO.ui.mixin.FloatableElement.call(this,t),this.originalVerticalPosition=this.verticalPosition,this.autoHide=void 0===t.autoHide||!!t.autoHide,this.hideOnChoose=void 0===t.hideOnChoose||!!t.hideOnChoose,this.filterFromInput=!!t.filterFromInput,this.$input=t.$input?t.$input:t.input?t.input.$input:null,this.$widget=t.widget?t.widget.$element:null,this.$autoCloseIgnore=t.$autoCloseIgnore||$([]),this.onDocumentMouseDownHandler=this.onDocumentMouseDown.bind(this),this.onInputEditHandler=OO.ui.debounce(this.updateItemVisibility.bind(this),100),this.highlightOnFilter=!!t.highlightOnFilter,this.lastHighlightedItem=null,this.width=t.width,this.filterMode=t.filterMode,this.$element.addClass("oo-ui-menuSelectWidget"),t.widget&&this.setFocusOwner(t.widget.$tabIndexed),this.visible=!1,this.$element.addClass("oo-ui-element-hidden"),this.$focusOwner.attr("aria-expanded","false")},OO.inheritClass(OO.ui.MenuSelectWidget,OO.ui.SelectWidget),OO.mixinClass(OO.ui.MenuSelectWidget,OO.ui.mixin.ClippableElement),OO.mixinClass(OO.ui.MenuSelectWidget,OO.ui.mixin.FloatableElement),OO.ui.MenuSelectWidget.static.flippedPositions={below:"above",above:"below",top:"bottom",bottom:"top"},OO.ui.MenuSelectWidget.prototype.onDocumentMouseDown=function(t){this.isVisible()&&!OO.ui.contains(this.$element.add(this.$widget).add(this.$autoCloseIgnore).get(),t.target,!0)&&this.toggle(!1)},OO.ui.MenuSelectWidget.prototype.onDocumentKeyDown=function(t){var e=this.findHighlightedItem()||this.findSelectedItem();if(!this.isDisabled()&&this.isVisible())switch(t.keyCode){case OO.ui.Keys.LEFT:case OO.ui.Keys.RIGHT:this.$input||OO.ui.MenuSelectWidget.parent.prototype.onDocumentKeyDown.call(this,t);break;case OO.ui.Keys.ESCAPE:case OO.ui.Keys.TAB:e&&!this.multiselect&&e.setHighlighted(!1),this.toggle(!1),t.keyCode===OO.ui.Keys.ESCAPE&&(t.preventDefault(),t.stopPropagation());break;default:return void OO.ui.MenuSelectWidget.parent.prototype.onDocumentKeyDown.call(this,t)}},OO.ui.MenuSelectWidget.prototype.updateItemVisibility=function(){var t,e,i,n,o,s,r,l,a=!1,u=this.items.length,c=!this.isVisible(),h=!1;if(this.$input&&this.filterFromInput){for(r=c?null:this.getItemMatcher(this.$input.val(),this.filterMode),l=this.getItemMatcher(this.$input.val(),"exact"),t=0;t<u;t++)(e=this.items[t])instanceof OO.ui.MenuSectionOptionWidget?(o&&o.toggle(c||!s),o=e,s=!0):e instanceof OO.ui.OptionWidget&&(n=c||r(e),h=h||l(e),a=a||n,s=s&&!n,e.toggle(n));if(o&&o.toggle(c||!s),a||this.highlightItem(null),this.$element.toggleClass("oo-ui-menuSelectWidget-invisible",!a),this.highlightOnFilter&&(!this.lastHighlightedItem||!this.lastHighlightedItem.isVisible())){for(e=null,i=this.getItems(),t=0;t<i.length;t++)if(i[t].isVisible()){e=i[t];break}this.highlightItem(e),this.lastHighlightedItem=e}}this.clip()},OO.ui.MenuSelectWidget.prototype.bindDocumentKeyDownListener=function(){this.$input?this.$input.on("keydown",this.onDocumentKeyDownHandler):OO.ui.MenuSelectWidget.parent.prototype.bindDocumentKeyDownListener.call(this)},OO.ui.MenuSelectWidget.prototype.unbindDocumentKeyDownListener=function(){this.$input?this.$input.off("keydown",this.onDocumentKeyDownHandler):OO.ui.MenuSelectWidget.parent.prototype.unbindDocumentKeyDownListener.call(this)},OO.ui.MenuSelectWidget.prototype.bindDocumentKeyPressListener=function(){this.$input?this.filterFromInput&&(this.$input.on("keydown mouseup cut paste change input select",this.onInputEditHandler),this.updateItemVisibility()):OO.ui.MenuSelectWidget.parent.prototype.bindDocumentKeyPressListener.call(this)},OO.ui.MenuSelectWidget.prototype.unbindDocumentKeyPressListener=function(){this.$input?this.filterFromInput&&(this.$input.off("keydown mouseup cut paste change input select",this.onInputEditHandler),this.updateItemVisibility()):OO.ui.MenuSelectWidget.parent.prototype.unbindDocumentKeyPressListener.call(this)},OO.ui.MenuSelectWidget.prototype.chooseItem=function(t){return OO.ui.MenuSelectWidget.parent.prototype.chooseItem.call(this,t),this.hideOnChoose&&this.toggle(!1),this},OO.ui.MenuSelectWidget.prototype.addItems=function(t,e){return OO.ui.MenuSelectWidget.parent.prototype.addItems.call(this,t,e),this.updateItemVisibility(),this},OO.ui.MenuSelectWidget.prototype.removeItems=function(t){return OO.ui.MenuSelectWidget.parent.prototype.removeItems.call(this,t),this.updateItemVisibility(),this},OO.ui.MenuSelectWidget.prototype.clearItems=function(){return OO.ui.MenuSelectWidget.parent.prototype.clearItems.call(this),this.updateItemVisibility(),this},OO.ui.MenuSelectWidget.prototype.toggle=function(t){var e,i,n;return e=(t=(void 0===t?!this.visible:!!t)&&!!this.items.length)!==this.isVisible(),!t||this.warnedUnattached||this.isElementAttached()||(OO.ui.warnDeprecation("MenuSelectWidget#toggle: Before calling this method, the menu must be attached to the DOM."),this.warnedUnattached=!0),e&&t&&this.setVerticalPosition(this.originalVerticalPosition),OO.ui.MenuSelectWidget.parent.prototype.toggle.call(this,t),e&&(t?(this.width?this.setIdealSize(this.width):this.$floatableContainer&&(this.$clippable.css("width","auto"),this.setIdealSize(this.$floatableContainer[0].offsetWidth>this.$clippable[0].offsetWidth?this.$floatableContainer[0].offsetWidth:"auto"),this.$clippable.css("width","")),this.togglePositioning(!!this.$floatableContainer),this.toggleClipping(!0),this.bindDocumentKeyDownListener(),this.bindDocumentKeyPressListener(),(this.isClippedVertically()||this.isFloatableOutOfView())&&"center"!==this.originalVerticalPosition&&(i=this.$element.height(),this.setVerticalPosition(this.constructor.static.flippedPositions[this.originalVerticalPosition]),(this.isClippedVertically()||this.isFloatableOutOfView())&&this.$element.height()<i&&this.setVerticalPosition(this.originalVerticalPosition)),this.$focusOwner.attr("aria-expanded","true"),n=this.findSelectedItem(),!this.multiselect&&n&&(this.$focusOwner.attr("aria-activedescendant",n.getElementId()),n.scrollElementIntoView({duration:0})),this.autoHide&&this.getElementDocument().addEventListener("mousedown",this.onDocumentMouseDownHandler,!0),this.emit("ready")):(this.$focusOwner.removeAttr("aria-activedescendant"),this.unbindDocumentKeyDownListener(),this.unbindDocumentKeyPressListener(),this.$focusOwner.attr("aria-expanded","false"),this.getElementDocument().removeEventListener("mousedown",this.onDocumentMouseDownHandler,!0),this.togglePositioning(!1),this.toggleClipping(!1),this.lastHighlightedItem=null)),this},OO.ui.MenuSelectWidget.prototype.scrollToTop=function(){this.$element.scrollTop(0)},OO.ui.mixin.RequestManager=function(t){this.requestCache={},this.requestQuery=null,this.requestRequest=null,this.showPendingRequest=!!this.pushPending&&!1!==t.showPendingRequest},OO.initClass(OO.ui.mixin.RequestManager),OO.ui.mixin.RequestManager.prototype.getRequestData=function(){var e,i=this,n=this.getRequestQuery(),o=$.Deferred();return this.abortRequest(),Object.prototype.hasOwnProperty.call(this.requestCache,n)?o.resolve(this.requestCache[n]):(this.showPendingRequest&&this.pushPending(),this.requestQuery=n,(e=this.requestRequest=this.getRequest()).always(function(){i.showPendingRequest&&i.popPending()}).done(function(t){e===i.requestRequest&&(i.requestQuery=null,i.requestRequest=null,i.requestCache[n]=i.getRequestCacheDataFromResponse(t),o.resolve(i.requestCache[n]))}).fail(function(){e===i.requestRequest&&(i.requestQuery=null,i.requestRequest=null,o.reject())})),o.promise()},OO.ui.mixin.RequestManager.prototype.abortRequest=function(){var t=this.requestRequest;t&&(this.requestRequest=null,this.requestQuery=null,t.abort())},OO.ui.mixin.RequestManager.prototype.getRequestQuery=null,OO.ui.mixin.RequestManager.prototype.getRequest=null,OO.ui.mixin.RequestManager.prototype.getRequestCacheDataFromResponse=null,OO.ui.mixin.LookupElement=function(t){t=$.extend({highlightFirst:!0},t),OO.ui.mixin.RequestManager.call(this,t),this.$overlay=(!0===t.$overlay?OO.ui.getDefaultOverlay():t.$overlay)||this.$element,this.lookupMenu=new OO.ui.MenuSelectWidget($.extend({widget:this,input:this,$floatableContainer:t.$container||this.$element},t.menu)),this.allowSuggestionsWhenEmpty=t.allowSuggestionsWhenEmpty||!1,this.lookupsDisabled=!1,this.lookupInputFocused=!1,this.lookupHighlightFirstItem=t.highlightFirst,this.showSuggestionsOnFocus=!1!==t.showSuggestionsOnFocus,this.$input.on({focus:this.onLookupInputFocus.bind(this),blur:this.onLookupInputBlur.bind(this),mousedown:this.onLookupInputMouseDown.bind(this)}),this.connect(this,{change:"onLookupInputChange"}),this.lookupMenu.connect(this,{toggle:"onLookupMenuToggle",choose:"onLookupMenuItemChoose"}),this.$input.attr({role:"combobox","aria-owns":this.lookupMenu.getElementId(),"aria-autocomplete":"list"}),this.$element.addClass("oo-ui-lookupElement"),this.lookupMenu.$element.addClass("oo-ui-lookupElement-menu"),this.$overlay.append(this.lookupMenu.$element)},OO.mixinClass(OO.ui.mixin.LookupElement,OO.ui.mixin.RequestManager),OO.ui.mixin.LookupElement.prototype.onLookupInputFocus=function(){this.lookupInputFocused=!0,this.showSuggestionsOnFocus&&this.populateLookupMenu()},OO.ui.mixin.LookupElement.prototype.onLookupInputBlur=function(){this.closeLookupMenu(),this.lookupInputFocused=!1},OO.ui.mixin.LookupElement.prototype.onLookupInputMouseDown=function(){this.lookupMenu.isVisible()||!this.lookupInputFocused&&this.showSuggestionsOnFocus||this.populateLookupMenu()},OO.ui.mixin.LookupElement.prototype.onLookupInputChange=function(){this.lookupInputFocused&&this.populateLookupMenu()},OO.ui.mixin.LookupElement.prototype.onLookupMenuToggle=function(t){t||(this.abortLookupRequest(),this.lookupMenu.clearItems())},OO.ui.mixin.LookupElement.prototype.onLookupMenuItemChoose=function(t){this.setValue(t.getData())},OO.ui.mixin.LookupElement.prototype.getLookupMenu=function(){return this.lookupMenu},OO.ui.mixin.LookupElement.prototype.setLookupsDisabled=function(t){this.lookupsDisabled=!!t},OO.ui.mixin.LookupElement.prototype.openLookupMenu=function(){return this.lookupMenu.isEmpty()||this.lookupMenu.toggle(!0),this},OO.ui.mixin.LookupElement.prototype.closeLookupMenu=function(){return this.lookupMenu.toggle(!1),this.abortLookupRequest(),this.lookupMenu.clearItems(),this},OO.ui.mixin.LookupElement.prototype.populateLookupMenu=function(){var e=this,t=this.getValue();if(!this.lookupsDisabled&&!this.isReadOnly())return this.allowSuggestionsWhenEmpty||""!==t?t!==this.lookupQuery&&this.getLookupMenuItems().done(function(t){e.lookupMenu.clearItems(),t.length?(e.lookupMenu.addItems(t).toggle(!0),e.initializeLookupMenuSelection()):e.lookupMenu.toggle(!1)}).fail(function(){e.lookupMenu.clearItems(),e.lookupMenu.toggle(!1)}):this.closeLookupMenu(),this},OO.ui.mixin.LookupElement.prototype.initializeLookupMenuSelection=function(){this.lookupHighlightFirstItem&&!this.lookupMenu.findSelectedItem()&&this.lookupMenu.highlightItem(this.lookupMenu.findFirstSelectableItem())},OO.ui.mixin.LookupElement.prototype.getLookupMenuItems=function(){return this.getRequestData().then(function(t){return this.getLookupMenuOptionsFromData(t)}.bind(this))},OO.ui.mixin.LookupElement.prototype.abortLookupRequest=function(){this.abortRequest()},OO.ui.mixin.LookupElement.prototype.getLookupRequest=null,OO.ui.mixin.LookupElement.prototype.getLookupCacheDataFromResponse=null,OO.ui.mixin.LookupElement.prototype.getLookupMenuOptionsFromData=null,OO.ui.mixin.LookupElement.prototype.setReadOnly=function(t){return OO.ui.TextInputWidget.prototype.setReadOnly.call(this,t),this.isReadOnly()&&this.lookupMenu&&this.closeLookupMenu(),this},OO.ui.mixin.LookupElement.prototype.getRequestQuery=function(){return this.getValue()},OO.ui.mixin.LookupElement.prototype.getRequest=function(){return this.getLookupRequest()},OO.ui.mixin.LookupElement.prototype.getRequestCacheDataFromResponse=function(t){return this.getLookupCacheDataFromResponse(t)},OO.ui.mixin.ItemWidget=function(){},OO.ui.mixin.ItemWidget.prototype.isDisabled=function(){return this.disabled||this.elementGroup instanceof OO.ui.Widget&&this.elementGroup.isDisabled()},OO.ui.mixin.ItemWidget.prototype.setElementGroup=function(t){return OO.ui.Element.prototype.setElementGroup.call(this,t),this.updateDisabled(),this},OO.ui.OptionWidget=function(t){t=t||{},OO.ui.OptionWidget.parent.call(this,t),OO.ui.mixin.ItemWidget.call(this),OO.ui.mixin.LabelElement.call(this,t),OO.ui.mixin.FlaggedElement.call(this,t),OO.ui.mixin.AccessKeyedElement.call(this,t),OO.ui.mixin.TitledElement.call(this,t),this.highlighted=!1,this.pressed=!1,this.setSelected(!!t.selected),this.$element.data("oo-ui-optionWidget",this).attr("tabindex","-1").attr("role","option").addClass("oo-ui-optionWidget").append(this.$label)},OO.inheritClass(OO.ui.OptionWidget,OO.ui.Widget),OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.ItemWidget),OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.LabelElement),OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.FlaggedElement),OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.AccessKeyedElement),OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.TitledElement),OO.ui.OptionWidget.static.selectable=!0,OO.ui.OptionWidget.static.highlightable=!0,OO.ui.OptionWidget.static.pressable=!0,OO.ui.OptionWidget.static.scrollIntoViewOnSelect=!1,OO.ui.OptionWidget.prototype.isSelectable=function(){return this.constructor.static.selectable&&!this.disabled&&this.isVisible()},OO.ui.OptionWidget.prototype.isHighlightable=function(){return this.constructor.static.highlightable&&!this.disabled&&this.isVisible()},OO.ui.OptionWidget.prototype.isPressable=function(){return this.constructor.static.pressable&&!this.disabled&&this.isVisible()},OO.ui.OptionWidget.prototype.isSelected=function(){return this.selected},OO.ui.OptionWidget.prototype.isHighlighted=function(){return this.highlighted},OO.ui.OptionWidget.prototype.isPressed=function(){return this.pressed},OO.ui.OptionWidget.prototype.setSelected=function(t){return this.constructor.static.selectable&&(this.selected=!!t,this.$element.toggleClass("oo-ui-optionWidget-selected",t).attr("aria-selected",t.toString()),t&&this.constructor.static.scrollIntoViewOnSelect&&this.scrollElementIntoView(),this.updateThemeClasses()),this},OO.ui.OptionWidget.prototype.setHighlighted=function(t){return this.constructor.static.highlightable&&(this.highlighted=!!t,this.$element.toggleClass("oo-ui-optionWidget-highlighted",t),this.updateThemeClasses()),this},OO.ui.OptionWidget.prototype.setPressed=function(t){return this.constructor.static.pressable&&(this.pressed=!!t,this.$element.toggleClass("oo-ui-optionWidget-pressed",t),this.updateThemeClasses()),this},OO.ui.OptionWidget.prototype.getMatchText=function(){var t=this.getLabel();return"string"==typeof t?t:this.$label.text()},OO.ui.DecoratedOptionWidget=function(t){OO.ui.DecoratedOptionWidget.parent.call(this,t),OO.ui.mixin.IconElement.call(this,t),OO.ui.mixin.IndicatorElement.call(this,t),this.$element.addClass("oo-ui-decoratedOptionWidget").prepend(this.$icon).append(this.$indicator)},OO.inheritClass(OO.ui.DecoratedOptionWidget,OO.ui.OptionWidget),OO.mixinClass(OO.ui.DecoratedOptionWidget,OO.ui.mixin.IconElement),OO.mixinClass(OO.ui.DecoratedOptionWidget,OO.ui.mixin.IndicatorElement),OO.ui.MenuOptionWidget=function(t){OO.ui.MenuOptionWidget.parent.call(this,t),this.checkIcon=new OO.ui.IconWidget({icon:"check",classes:["oo-ui-menuOptionWidget-checkIcon"]}),this.$element.prepend(this.checkIcon.$element).addClass("oo-ui-menuOptionWidget")},OO.inheritClass(OO.ui.MenuOptionWidget,OO.ui.DecoratedOptionWidget),OO.ui.MenuOptionWidget.static.scrollIntoViewOnSelect=!0,function(l){"use strict";l.ui.WikimediaUITheme=function(){l.ui.WikimediaUITheme.parent.call(this)},l.inheritClass(l.ui.WikimediaUITheme,l.ui.Theme),l.ui.WikimediaUITheme.prototype.getElementClasses=function(t){var e,i,n,o,s={invert:!1,progressive:!1,destructive:!1,error:!1,warning:!1,success:!1},r=l.ui.WikimediaUITheme.parent.prototype.getElementClasses.call(this,t);for(e in t instanceof l.ui.IconWidget&&t.$element.hasClass("oo-ui-checkboxInputWidget-checkIcon")?s.invert=!0:t.supports(["hasFlag"])&&(i=t.supports(["isFramed"])&&t.isFramed(),n=t.supports(["isActive"])&&t.isActive(),o=l.ui.Tool&&t instanceof l.ui.Tool||l.ui.ToolGroup&&t instanceof l.ui.ToolGroup,i&&(n||t.isDisabled()||t.hasFlag("primary"))||o&&t.hasFlag("primary")?s.invert=!0:i||!t.isDisabled()||t.hasFlag("invert")?t.isDisabled()||(s.progressive=t.hasFlag("progressive")||o&&n||(t instanceof l.ui.MenuOptionWidget||l.ui.OutlineOptionWidget&&t instanceof l.ui.OutlineOptionWidget)&&(t.isPressed()||t.isSelected()),s.destructive=t.hasFlag("destructive"),s.invert=t.hasFlag("invert"),s.error=t.hasFlag("error"),s.warning=t.hasFlag("warning"),s.success=t.hasFlag("success")):s.invert=!1),s)r[s[e]?"on":"off"].push("oo-ui-image-"+e);return r},l.ui.WikimediaUITheme.prototype.getDialogTransitionDuration=function(){return 250},l.ui.theme=new l.ui.WikimediaUITheme}(OO),window.mwNow=Date.now,window.module||(window.module={}),window.$VARS={baseModules:[]},window.$CODE={profileExecuteStart:function(){},profileExecuteEnd:function(){},profileScriptStart:function(){},profileScriptEnd:function(){}},window.RLQ=[],function(){"use strict";var D,L,n,t,e,P=Object.prototype.hasOwnProperty;function i(){L=window.Set||function(){var e=Object.create(null);return{add:function(t){e[t]=!0},has:function(t){return t in e}}}}function o(t,e,i){t.values[e]=i,n.deprecate(window,e,i,t===D.config&&"Use mw.config instead.")}function s(t){this.values=Object.create(null),!0===t&&(this.set=function(t,e){var i;if(1<arguments.length){if("string"==typeof t)return o(this,t,e),!0}else if("object"==typeof t){for(i in t)o(this,i,t[i]);return!0}return!1})}s.prototype={constructor:s,get:function(t,e){var i,n;if(e=1<arguments.length?e:null,Array.isArray(t)){for(i={},n=0;n<t.length;n++)"string"==typeof t[n]&&(i[t[n]]=t[n]in this.values?this.values[t[n]]:e);return i}if("string"==typeof t)return t in this.values?this.values[t]:e;if(void 0!==t)return e;for(n in i={},this.values)i[n]=this.values[n];return i},set:function(t,e){var i;if(1<arguments.length){if("string"==typeof t)return this.values[t]=e,!0}else if("object"==typeof t){for(i in t)this.values[i]=t[i];return!0}return!1},exists:function(t){var e;if(Array.isArray(t)){for(e=0;e<t.length;e++)if("string"!=typeof t[e]||!(t[e]in this.values))return!1;return!0}return"string"==typeof t&&t in this.values}},i(),t=function(){},e=window.console,t.warn=e&&e.warn?Function.prototype.bind.call(e.warn,e):function(){},t.error=e&&e.error?Function.prototype.bind.call(e.error,e):function(){},t.deprecate=function(i,n,e,o,s){var r;function l(){var t=s||n,e=(new Error).stack;r||(r=new L),r.has(e)||(r.add(e),(s||i===window)&&D.track("mw.deprecate",t),D.log.warn('Use of "'+t+'" is deprecated.'+(o?" "+o:"")))}try{Object.defineProperty(i,n,{configurable:!0,enumerable:!0,get:function(){return l(),e},set:function(t){l(),e=t}})}catch(t){i[n]=e}},n=t,D={redefineFallbacksForTest:function(){if(!window.QUnit)throw new Error("Not allowed");i()},now:function(){var t=window.performance,e=t&&t.timing&&t.timing.navigationStart;return D.now=e&&t.now?function(){return e+t.now()}:Date.now,D.now()},trackQueue:[],track:function(t,e){D.trackQueue.push({topic:t,timeStamp:D.now(),data:e})},trackError:function(t,e){var i,n,o,s;D.track(t,e),o=(i=e).exception,(s=window.console)&&s.log&&(n=(o?"Exception":"Error")+" in "+i.source+(i.module?" in module "+i.module:"")+(o?":":"."),s.log(n),o&&s.warn&&s.warn(o))},Map:s,config:null,libs:{},legacy:{},messages:new s,templates:new s,log:n,loader:function(){var i,v=Object.create(null),x=Object.create(null),h=!1,p=[],r=[],a=[],u=!1,c=[],d=$VARS.baseModules,m=document.querySelector('meta[name="ResourceLoaderDynamicStyles"]'),n=window.requestAnimationFrame||setTimeout;function o(t,e){var i=document.createElement("style");return i.appendChild(document.createTextNode(t)),e&&e.parentNode?e.parentNode.insertBefore(i,e):document.head.appendChild(i),i}function g(t,e){i&&!1!==i.active&&"@import"!==t.slice(0,"@import".length)||(i={cssText:"",callbacks:[],active:null}),i.cssText+="\n"+t,i.callbacks.push(e),null===i.active&&(i.active=!0,n(function(t){var e;for(t.active=!1,o(t.cssText,m),e=0;e<t.callbacks.length;e++)t.callbacks[e]()}.bind(null,i)))}function f(t){for(var e=0;e<t.length;e++)if("ready"!==D.loader.getState(t[e]))return!1;return!0}function O(t){for(var e,i=0;i<t.length;i++)if("error"===(e=D.loader.getState(t[i]))||"missing"===e)return!0;return!1}function s(){var t,e,i,n,o,s,r,l=!0;do{for(l=!1;c.length;)for(i in t=c.shift(),e=-1!==d.indexOf(t),v)"error"!==v[i].state&&"missing"!==v[i].state&&(e&&-1===d.indexOf(i)?(v[i].state="error",l=!0):-1!==v[i].dependencies.indexOf(t)&&(v[i].state="error",c.push(i),l=!0));for(i in v)"loaded"===v[i].state&&(f(v[r=i].dependencies)&&(-1!==d.indexOf(r)||f(d)))&&(C(i),l=!0);for(n=0;n<a.length;n++)if((o=O((s=a[n]).dependencies))||f(s.dependencies)){a.splice(n,1),n-=1;try{o&&s.error?s.error(new Error("Failed dependencies"),s.dependencies):!o&&s.ready&&s.ready()}catch(t){D.trackError("resourceloader.exception",{exception:t,source:"load-callback"})}l=!0}}while(l);u=!1}function y(t,e){"loaded"!==(v[t].state=e)&&"ready"!==e&&"error"!==e&&"missing"!==e||("ready"===e?D.loader.store.add(t):"error"!==e&&"missing"!==e||c.push(t),u||(u=!0,D.requestIdleCallback(s,{timeout:1})))}function l(t,e,i){var n,o,s;if(!(t in v))throw new Error("Unknown module: "+t);if("string"==typeof v[t].skip&&(o=new Function(v[t].skip)(),v[t].skip=!!o,o))return v[t].dependencies=[],void y(t,"ready");for(i||(i=new L),s=v[t].dependencies,i.add(t),n=0;n<s.length;n++)if(-1===e.indexOf(s[n])){if(i.has(s[n]))throw new Error("Circular reference detected: "+t+" -> "+s[n]);l(s[n],e,i)}e.push(t)}function b(t){for(var e=d.slice(),i=0;i<t.length;i++)l(t[i],e);return e}function E(t,e){var i=document.createElement("script");i.src=t,i.onload=i.onerror=function(){i.parentNode&&i.parentNode.removeChild(i),e&&(e(),e=null)},document.head.appendChild(i)}function w(t,e,i){var n=document.createElement("link");n.rel="stylesheet",e&&"all"!==e&&(n.media=e),n.href=t,i&&i.parentNode?i.parentNode.insertBefore(n,i):document.head.appendChild(n)}function I(t){var e=document.createElement("script");!1!==D.config.get("wgCSPNonce")&&(e.nonce=D.config.get("wgCSPNonce")),e.text=t,document.head.appendChild(e),e.parentNode.removeChild(e)}function $(t,e,i){f(t)?void 0!==e&&e():O(t)?void 0!==i&&i(new Error("One or more dependencies failed to load"),t):(void 0===e&&void 0===i||a.push({dependencies:t.filter(function(t){var e=v[t].state;return"registered"===e||"loaded"===e||"loading"===e||"executing"===e}),ready:e,error:i}),t.forEach(function(t){"registered"===v[t].state&&-1===r.indexOf(t)&&("private"===v[t].group?y(t,"error"):r.push(t))}),D.loader.work())}function C(l){var t,e,i,n,o,s,r,a,u,c=0;if("loaded"!==v[l].state)throw new Error('Module in state "'+v[l].state+'" may not be executed: '+l);if(v[l].state="executing",$CODE.profileExecuteStart(),u=function(){var t,e,r,i;$CODE.profileScriptStart(),t=v[l].script,e=function(){$CODE.profileScriptEnd(),y(l,"ready")},r=function(t,e,i){var n,o,s;i>=t.length?e():(n=t[i],o=l,s=function(){r(t,e,i+1)},p.push(function(){"jquery"!==o&&(window.require=D.loader.require,window.module=v[o].module),E(n,function(){delete window.module,s(),p[0]?p.shift()():h=!1})}),!h&&p[0]&&(h=!0,p.shift()()))};try{if(Array.isArray(t))r(t,e,0);else if("function"==typeof t||"object"==typeof t&&null!==t){if("function"==typeof t)"jquery"===l?t():t(window.$,window.$,D.loader.require,v[l].module);else{if("function"!=typeof(i=t.files[t.main]))throw new Error("Main file "+t.main+" in module "+l+" must be of type function, found "+typeof i);i(function r(l,a){return function(t){var e,i,n,o,s=l.script.files;if(null===(e=function(t,e){var i,n,o,s=t.match(/^((?:\.\.?\/)+)(.*)$/);if(!s)return null;for((o=e.split("/")).pop(),(i=s[1].split("/")).pop();void 0!==(n=i.pop());)".."===n&&o.pop();return(o.length?o.join("/")+"/":"")+s[2]}(t,a)))return D.loader.require(t);if(!P.call(s,e))throw new Error("Cannot require() undefined file "+e);return P.call(l.packageExports,e)?l.packageExports[e]:(n="function"==typeof(i=s[e])?(o={exports:{}},i(r(l,e),o),o.exports):i,l.packageExports[e]=n)}}(v[l],t.main),v[l].module)}e()}else"string"==typeof t&&I(t),e()}catch(t){y(l,"error"),$CODE.profileScriptEnd(),D.trackError("resourceloader.exception",{exception:t,module:l,source:"module-execute"})}},v[l].messages&&D.messages.set(v[l].messages),v[l].templates&&D.templates.set(l,v[l].templates),s=function(){return c++,function(){var t;0===--c&&(t=u,u=void 0,t())}},v[l].style)for(t in v[l].style)if(e=v[l].style[t],i=void 0,"url"!==t&&"css"!==t&&("string"==typeof e?g(e,s()):(i=t,t="bc-url")),Array.isArray(e))for(n=0;n<e.length;n++)"bc-url"===t?w(e[n],i,m):"css"===t&&g(e[n],s());else if("object"==typeof e)for(i in e)for(o=e[i],n=0;n<o.length;n++)w(o[n],i,m);if($CODE.profileExecuteEnd(),"user"===l){try{r=b(["site"])}catch(t){a=t,u()}void 0===a&&$(r,u,u)}else 0===c&&u()}function T(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}function W(t){var e,i,n,o,s,r,l,a,u,c,h,p,d,m,g,f,O,y,b;function w(){var t=Object.create(h),e=function(t){var e,i,n=[],o=[];function s(t){return e+t}for(i in t)e=""===i?"":i+".",n.push(e+t[i].join(",")),o.push.apply(o,t[i].map(s));return{str:n.join("|"),list:o}}(d);t.modules=e.str,t.version=function(t){for(var e=2166136261,i=0;i<t.length;i++)e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24),e^=t.charCodeAt(i);for(e=(e>>>0).toString(36);e.length<7;)e="0"+e;return e}(e.list.reduce(function(t,e){return t+v[e].version},"")),t=function(t){var e,i={},n=[];for(e in t)n.push(e);for(n.sort(),e=0;e<n.length;e++)i[n[e]]=t[n[e]];return i}(t),E(c+"?"+T(t))}if(t.length){for(t.sort(),e={skin:D.config.get("skin"),lang:D.config.get("wgUserLanguage"),debug:D.config.get("debug")},i=Object.create(null),n=0;n<t.length;n++)o=v[t[n]].source,s=v[t[n]].group,i[o]||(i[o]=Object.create(null)),i[o][s]||(i[o][s]=[]),i[o][s].push(t[n]);for(r in i)for(l in c=x[r],i[r]){for(u=i[r][l],h=Object.create(e),"user"===l&&null!==D.config.get("wgUserName")&&(h.user=D.config.get("wgUserName")),g=p=T(h).length+25,d=Object.create(null),m=[],a=0;a<u.length;a++)f=u[a].lastIndexOf("."),O=u[a].substr(0,f),y=u[a].slice(f+1),b=d[O]?y.length+3:u[a].length+3,m.length&&g+b>D.loader.maxQueryLength&&(w(),g=p,d=Object.create(null),m=[],D.track("resourceloader.splitRequest",{maxQueryLength:D.loader.maxQueryLength})),d[O]||(d[O]=[]),g+=b,d[O].push(y),m.push(u[a]);m.length&&w()}}}function S(t){return t in v?t+"@"+v[t].version:null}function k(t,e,i,n,o,s){if(t in v)throw new Error("module already registered: "+t);v[t]={module:{exports:{}},packageExports:{},version:String(e||""),dependencies:i||[],group:"string"==typeof n?n:null,source:"string"==typeof o?o:"local",state:"registered",skip:"string"==typeof s?s:null}}return{moduleRegistry:v,maxQueryLength:$VARS.maxQueryLength,addStyleTag:o,enqueue:$,resolve:b,work:function(){for(var i,n,t,e,o=[],s=0;s<r.length;s++)r[s]in v&&"registered"===v[r[s]].state&&-1===o.indexOf(r[s])&&(o.push(r[s]),v[r[s]].state="loading");(r=[],o.length)&&(D.loader.store.init(),D.loader.store.enabled&&(i=[],n=[],o=o.filter(function(t){var e=D.loader.store.get(t);return!e||(i.push(e),n.push(t),!1)}),e=function(t){D.loader.store.stats.failed++,D.loader.store.clear(),D.trackError("resourceloader.exception",{exception:t,source:"store-eval"}),W(n.filter(function(t){return"loading"===v[t].state}))},(t=i).length&&D.requestIdleCallback(function(){try{I(t.join(";"))}catch(t){e(t)}})),W(o))},addSource:function(t){var e;for(e in t){if(e in x)throw new Error("source already registered: "+e);x[e]=t[e]}},register:function(t){var e;if("object"==typeof t)for(function(t){var e,i,n,o;for(e=0;e<t.length;e++)if(n=t[e][2])for(i=0;i<n.length;i++)n[i]="number"==typeof(o=n[i])?t[o][0]:o}(t),e=0;e<t.length;e++)k.apply(null,t[e]);else k.apply(null,arguments)},implement:function(t,e,i,n,o){var s,r,l=-1===(r=(s=t).indexOf("@"))?{name:s,version:""}:{name:s.slice(0,r),version:s.slice(r+1)},a=l.name,u=l.version;if(a in v||D.loader.register(a),void 0!==v[a].script)throw new Error("module already implemented: "+a);u&&(v[a].version=u),v[a].script=e||null,v[a].style=i||null,v[a].messages=n||null,v[a].templates=o||null,"error"!==v[a].state&&"missing"!==v[a].state&&y(a,"loaded")},load:function(t,e){if("string"==typeof t&&/^(https?:)?\/?\//.test(t))if("text/css"===e)w(t);else{if("text/javascript"!==e&&void 0!==e)throw new Error("type must be text/css or text/javascript, found "+e);E(t)}else $(function(t){for(var e,i=d.slice(),n=0;n<t.length;n++){e=i.slice();try{l(t[n],i)}catch(t){i=e,D.trackError("resourceloader.exception",{exception:t,source:"resolve"})}}return i}(t="string"==typeof t?[t]:t),void 0,void 0)},state:function(t){var e,i;for(e in t)i=t[e],e in v||D.loader.register(e),y(e,i)},getVersion:function(t){return t in v?v[t].version:null},getState:function(t){return t in v?v[t].state:null},getModuleNames:function(){return Object.keys(v)},require:function(t){if("ready"!==D.loader.getState(t))throw new Error('Module "'+t+'" is not loaded');return v[t].module.exports},store:{enabled:null,MODULE_SIZE_MAX:1e5,items:{},queue:[],stats:{hits:0,misses:0,expired:0,failed:0},toJSON:function(){return{items:D.loader.store.items,vary:D.loader.store.getVary()}},getStoreKey:function(){return"MediaWikiModuleStore:"+D.config.get("wgDBname")},getVary:function(){return D.config.get("skin")+":"+D.config.get("wgResourceLoaderStorageVersion")+":"+D.config.get("wgUserLanguage")},init:function(){var t,e;if(null===this.enabled){if(/Firefox/.test(navigator.userAgent)||!D.config.get("wgResourceLoaderStorageEnabled"))return this.clear(),void(this.enabled=!1);if(D.config.get("debug"))this.enabled=!1;else{try{if(t=localStorage.getItem(this.getStoreKey()),this.enabled=!0,(e=JSON.parse(t))&&"object"==typeof e.items&&e.vary===this.getVary())return void(this.items=e.items)}catch(t){}void 0===t&&(this.enabled=!1)}}},get:function(t){var e;return!!this.enabled&&((e=S(t))in this.items?(this.stats.hits++,this.items[e]):(this.stats.misses++,!1))},add:function(t){this.enabled&&(this.queue.push(t),this.requestUpdate())},set:function(t){var e,i,n,o,s=D.loader.moduleRegistry[t];if(!((e=S(t))in this.items)&&s&&"ready"===s.state&&s.version&&"private"!==s.group&&"user"!==s.group&&-1===[s.script,s.style,s.messages,s.templates].indexOf(void 0)){try{o="function"==typeof s.script?String(s.script):"object"==typeof s.script&&s.script&&!Array.isArray(s.script)?"{main:"+JSON.stringify(s.script.main)+",files:{"+Object.keys(s.script.files).map(function(t){var e=s.script.files[t];return JSON.stringify(t)+":"+("function"==typeof e?e:JSON.stringify(e))}).join(",")+"}}":JSON.stringify(s.script),i=[JSON.stringify(e),o,JSON.stringify(s.style),JSON.stringify(s.messages),JSON.stringify(s.templates)]}catch(t){return void D.trackError("resourceloader.exception",{exception:t,source:"store-localstorage-json"})}(n="mw.loader.implement("+i.join(",")+");").length>this.MODULE_SIZE_MAX||(this.items[e]=n)}},prune:function(){var t;for(t in this.items)S(t.slice(0,t.indexOf("@")))!==t?(this.stats.expired++,delete this.items[t]):this.items[t].length>this.MODULE_SIZE_MAX&&delete this.items[t]},clear:function(){this.items={};try{localStorage.removeItem(this.getStoreKey())}catch(t){}},requestUpdate:function(){var i=!1;function t(){var t,e;for(D.loader.store.prune();D.loader.store.queue.length;)D.loader.store.set(D.loader.store.queue.shift());e=D.loader.store.getStoreKey();try{localStorage.removeItem(e),t=JSON.stringify(D.loader.store),localStorage.setItem(e,t)}catch(t){D.trackError("resourceloader.exception",{exception:t,source:"store-localstorage-update"})}i=!1}function e(){D.requestIdleCallback(t)}return function(){i||(i=!0,setTimeout(e,2e3))}}()}}}(),user:{options:new s,tokens:new s},widgets:{}},window.mw=window.mediaWiki=D}(),function(){"use strict";var t,i,o=Array.prototype.slice,n=mw.track,s=$.Callbacks("memory"),r=[];function l(t,e,i){return this.format="text",this.map=t,this.key=e,this.parameters=void 0===i?[]:o.call(i),this}for(l.prototype={parser:function(){var t=this.map.get(this.key);return"qqx"!==mw.config.get("wgUserLanguage")||t&&t!=="("+this.key+")"||(t="("+this.key+"$*)"),mw.format.apply(null,[t].concat(this.parameters))},params:function(t){var e;for(e=0;e<t.length;e++)this.parameters.push(t[e]);return this},toString:function(){var t;return this.exists()?("plain"!==this.format&&"text"!==this.format&&"parse"!==this.format||(t=this.parser()),"escaped"===this.format&&(t=this.parser(),t=mw.html.escape(t)),t):""+mw.html.escape(this.key)+""},parse:function(){return this.format="parse",this.toString()},plain:function(){return this.format="plain",this.toString()},text:function(){return this.format="text",this.toString()},escaped:function(){return this.format="escaped",this.toString()},exists:function(){return"qqx"===mw.config.get("wgUserLanguage")||this.map.exists(this.key)}},mw.inspect=function(){var t=arguments;mw.loader.using("mediawiki.inspect",function(){mw.inspect.runReports.apply(mw.inspect,t)})},mw.internalDoTransformFormatForQqx=function(t,e){var i;return-1!==t.indexOf("$*")?(i="",e.length&&(i=": "+e.map(function(t,e){return"$"+(e+1)}).join(", ")),t.replace("$*",i)):t},mw.format=function(t){var n=o.call(arguments,1);return(t=mw.internalDoTransformFormatForQqx(t,n)).replace(/\$(\d+)/g,function(t,e){var i=parseInt(e,10)-1;return void 0!==n[i]?n[i]:"$"+e})},mw.Message=l,mw.message=function(t){var e=o.call(arguments,1);return new l(mw.messages,t,e)},mw.msg=function(){return mw.message.apply(mw.message,arguments).toString()},mw.track=function(t,e){n(t,e),s.fire(mw.trackQueue)},mw.trackSubscribe=function(i,n){var o=0;function t(t){for(var e;o<t.length;o++)0===(e=t[o]).topic.indexOf(i)&&n.call(e,e.topic,e.data)}r.push([t,n]),s.add(t)},mw.trackUnsubscribe=function(e){r=r.filter(function(t){return t[1]!==e||(s.remove(t[0]),!1)})},s.fire(mw.trackQueue),mw.hook=(i=Object.create(null),function(t){var e=i[t]||(i[t]=$.Callbacks("memory"));return{add:e.add,remove:e.remove,fire:function(){return e.fireWith.call(this,null,o.call(arguments))}}}),mw.html=function(){function e(t){switch(t){case"'":return"&#039;";case'"':return"&quot;";case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;"}}return{escape:function(t){return t.replace(/['"<>&]/g,e)},element:function(t,e,i){var n,o,s="<"+t;if(e)for(o in e){if(!0===(n=e[o]))n=o;else if(!1===n)continue;s+=" "+o+'="'+this.escape(String(n))+'"'}if(null==i)return s+="/>";switch(s+=">",typeof i){case"string":s+=this.escape(i);break;case"number":case"boolean":s+=String(i);break;default:if(i instanceof this.Raw)s+=i.value;else{if(!(i instanceof this.Cdata))throw new Error("Invalid type of contents");if(/<\/[a-zA-z]/.test(i.value))throw new Error("Illegal end tag found in CDATA");s+=i.value}}return s+="</"+t+">"},Raw:function(t){this.value=t},Cdata:function(t){this.value=t}}}(),mw.loader.using=function(t,e,i){var n=$.Deferred();Array.isArray(t)||(t=[t]),e&&n.done(e),i&&n.fail(i);try{t=mw.loader.resolve(t)}catch(t){return n.reject(t).promise()}return mw.loader.enqueue(t,function(){n.resolve(mw.loader.require)},n.reject),n.promise()},mw.loader.getScript=function(t){return $.ajax(t,{dataType:"script",cache:!0}).catch(function(){throw new Error("Failed to load script")})},mw.log.deprecate(window,"$j",$,"Use $ or jQuery instead."),t=window.RLQ,window.RLQ={push:function(t){"function"==typeof t?t():mw.loader.using(t[0],t[1])}};t[0];)window.RLQ.push(t.shift())}(),mw.RegExp={escape:function(t){return t.replace(/([\\{}()|.?*+\-^$\[\]])/g,"\\$1")}},window.mwPerformance={mark:function(){}},window.require=mw.loader.require,mw.requestIdleCallback=function(t){t()},mw.config=new mw.Map,mw.config.set({wgScriptPath:window.TitleInputWidgetConfig&&TitleInputWidgetConfig.wgScriptPath||"https://en.wikipedia.org/w",wgArticlePath:window.TitleInputWidgetConfig&&TitleInputWidgetConfig.wgArticlePath||"https://en.wikipedia.org/wiki/$1",wgCaseSensitiveNamespaces:[],wgContentLanguage:navigator.language||"en",wgRelevantPageName:"/",wgLegalTitleChars:" %!\"$&'()*,-./0-9:;=?@A-Z\\^_`a-z~+-",wgNamespaceIds:{media:-2,special:-1,"":0,talk:1,user:2,user_talk:3,project:4,project_talk:5,file:6,file_talk:7,mediawiki:8,mediawiki_talk:9,template:10,template_talk:11,help:12,help_talk:13,category:14,category_talk:15,page:250,page_talk:251,index:252,index_talk:253,campaign:460,campaign_talk:461,module:828,module_talk:829,topic:2600,image:6,image_talk:7}}),mw.messages.set("mw-widgets-titleinput-description-redirect","redirect to $1"),mw.messages.set("mw-widgets-titleinput-description-new-page","page does not exist yet"),mw.loader.implement("./config.json",function(t,e,i,n){n.exports={FragmentMode:["legacy","html5"]}}),function(){"use strict";var l,e=require("./config.json"),t=e;function i(t){return t=String(t),encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/~/g,"%7E")}function n(t,e){switch(t=String(t),e){case"html5":return t.replace(/ /g,"_");case"legacy":return i(t.replace(/ /g,"_")).replace(/%3A/g,":").replace(/%/g,".");default:throw new Error("Unrecognized ID escaping mode "+e)}}l={setOptionsForTest:function(t){if(!window.QUnit)throw new Error("Modifying options not allowed outside unit tests");e=$.extend({},e,t)},resetOptionsForTest:function(){if(!window.QUnit)throw new Error("Resetting options not allowed outside unit tests");e=t},rawurlencode:i,escapeIdForAttribute:function(t){return n(t,e.FragmentMode[0])},escapeIdForLink:function(t){return n(t,e.FragmentMode[0])},wikiUrlencode:function(t){return l.rawurlencode(t).replace(/%20/g,"_").replace(/%3B/g,";").replace(/%40/g,"@").replace(/%24/g,"$").replace(/%21/g,"!").replace(/%2A/g,"*").replace(/%28/g,"(").replace(/%29/g,")").replace(/%2C/g,",").replace(/%2F/g,"/").replace(/%7E/g,"~").replace(/%3A/g,":")},getUrl:function(t,e){var i,n,o,s="",r="string"==typeof t?t:mw.config.get("wgPageName");return-1!==(i=r.indexOf("#"))&&(s=r.slice(i+1),r=r.slice(0,i)),e&&(o=$.param(e)),n=o?r?l.wikiScript()+"?title="+l.wikiUrlencode(r)+"&"+o:l.wikiScript()+"?"+o:mw.config.get("wgArticlePath").replace("$1",l.wikiUrlencode(r).replace(/\$/g,"$$$$")),s.length&&(n+="#"+l.escapeIdForLink(s)),n},wikiScript:function(t){return"index"===(t=t||"index")?mw.config.get("wgScript"):"load"===t?mw.config.get("wgLoadScript"):mw.config.get("wgScriptPath")+"/"+t+".php"},addCSS:function(t){var e=mw.loader.addStyleTag(t);return e.sheet||e.styleSheet||e},getParamValue:function(t,e){var i=new RegExp("^[^#]*[&?]"+mw.RegExp.escape(t)+"=([^&#]*)").exec(void 0!==e?e:location.href);return i?decodeURIComponent(i[1].replace(/\+/g,"%20")):null},$content:null,addPortletLink:function(t,e,i,n,o,s,r){var l,a,u,c,h,p,d;return t&&(c=document.getElementById(t))?((a=document.createElement("a")).href=e,a.textContent=i,o&&(a.title=o),s&&(a.accessKey=s),(u=$(c)).removeClass("emptyPortlet"),l=u.hasClass("vectorTabs")?$("<li>").append($("<span>").append(a)[0])[0]:$("<li>").append(a)[0],n&&(l.id=n),(p=c.querySelector("ul"))||(p=document.createElement("ul"),(h=c.querySelector("div"))?h.appendChild(p):c.appendChild(p)),r&&("string"==typeof r||r.nodeType||r.jquery)&&1===(r=$(p).find(r)).length&&r[0].parentNode===p&&(r.before(l),d=!0),d||p.appendChild(l),s&&$(a).updateTooltipAccessKeys(),l):null},validateEmail:function(t){var e,i;return""===t?null:("a-z0-9!#$%&'*+\\-/=?^_`{|}~",e="a-z0-9\\-",i=new RegExp("^[a-z0-9!#$%&'*+\\-/=?^_`{|}~\\.]+@["+e+"]+(?:\\.["+e+"]+)*$","i"),null!==t.match(i))},isIPv4Address:function(t,e){var i;return"string"==typeof t&&("(?:"+(i="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|0?[0-9]?[0-9])")+"\\.){3}"+i,new RegExp("^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|0?[0-9]?[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|0?[0-9]?[0-9])"+(e?"(?:\\/(?:3[0-2]|[12]?\\d))?":"")+"$").test(t))},isIPv6Address:function(t,e){var i,n;return"string"==typeof t&&(i=e?"(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?\\d))?":"",n="(?::(?::|(?::[0-9A-Fa-f]{1,4}){1,7})|[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4}){0,6}::|[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4}){7})",!!new RegExp("^"+n+i+"$").test(t)||(n="[0-9A-Fa-f]{1,4}(?:::?[0-9A-Fa-f]{1,4}){1,6}",new RegExp("^"+n+i+"$").test(t)&&/::/.test(t)&&!/::.*::/.test(t)))},isIPAddress:function(t,e){return l.isIPv4Address(t,e)||l.isIPv6Address(t,e)}},$(function(){l.$content=function(){var t,e,i,n;for(t=0,e=(n=[".mw-body-primary",".mw-body","#mw-content-text"]).length;t<e;t++)if((i=$(n[t])).length)return i.first();return $("body")}()}),mw.util=l,module.exports=l}(),function(){var n={parameters:{action:"query",format:"json"},ajax:{url:mw.util.wikiScript("api"),timeout:3e4,dataType:"json"}},r={};function l(t){return-1!==["edit","delete","protect","move","block","unblock","email","import","options"].indexOf(t)?(mw.track("mw.deprecate","apitoken_"+t),mw.log.warn('Use of the "'+t+'" token is deprecated. Use "csrf" instead.'),"csrf"):t}r[n.ajax.url]={},$.each(mw.user.tokens.get(),function(t,e){r[n.ajax.url][t]=$.Deferred().resolve(e).promise({abort:function(){}})}),mw.Api=function(t){var e=$.extend({},t),i=t&&t.ajax&&void 0!==t.ajax.url;e.parameters=$.extend({},n.parameters,e.parameters),e.ajax=$.extend({},n.ajax,e.ajax),i&&(e.ajax.url=String(e.ajax.url)),void 0===e.useUS&&(e.useUS=!i),this.defaults=e,this.requests=[]},mw.Api.prototype={abort:function(){this.requests.forEach(function(t){t&&t.abort()})},get:function(t,e){return(e=e||{}).type="GET",this.ajax(t,e)},post:function(t,e){return(e=e||{}).type="POST",this.ajax(t,e)},preprocessParameters:function(t,e){var i;for(i in t)Array.isArray(t[i])?e&&-1!==t[i].join("").indexOf("|")?t[i]=""+t[i].join(""):t[i]=t[i].join("|"):!1!==t[i]&&void 0!==t[i]||delete t[i]},ajax:function(t,e){var i,n,o,s,r,l=this,a=$.Deferred();if(t=$.extend({},this.defaults.parameters,t),e=$.extend({},this.defaults.ajax,e),t.token&&(i=t.token,delete t.token),this.preprocessParameters(t,this.defaults.useUS),"POST"===e.type&&window.FormData&&"multipart/form-data"===e.contentType){for(s in r=new FormData,t)r.append(s,t[s]);i&&r.append("token",i),e.data=r,e.processData=!1,e.contentType=!1}else e.data=$.param(t),i&&(e.data+="&token="+encodeURIComponent(i)),e.data=e.data.replace(/\./g,"%2E"),"multipart/form-data"===e.contentType&&delete e.contentType;return o=$.ajax(e).fail(function(t,e,i){a.reject("http",{xhr:t,textStatus:e,exception:i})}).done(function(t,e,i){var n;null==t||""===t?a.reject("ok-but-empty","OK response but empty result (check HTTP headers?)",t,i):t.error?(n=void 0===t.error.code?"unknown":t.error.code,a.reject(n,t,t,i)):t.errors?(n=void 0===t.errors[0].code?"unknown":t.errors[0].code,a.reject(n,t,t,i)):a.resolve(t,i)}),n=this.requests.length,this.requests.push(o),o.always(function(){l.requests[n]=null}),a.promise({abort:o.abort}).fail(function(t,e){"http"===t&&e&&"abort"===e.textStatus||mw.log("mw.Api error: ",t,e)})},postWithToken:function(e,i,n){var o,s,r=this,l=$.Deferred().reject("http",{textStatus:"abort",exception:"abort"}).promise();return r.getToken(e,i.assert).then(function(t){return i.token=t,s?l:(o=r.post(i,n)).catch(function(t){return"badtoken"===t?(r.badToken(e),i.token=void 0,o=null,r.getToken(e,i.assert).then(function(t){return i.token=t,s?l:o=r.post(i,n)})):$.Deferred().rejectWith(this,arguments)})}).promise({abort:function(){o?o.abort():s=!0}})},getToken:function(e,t){var i,n,o,s;return e=l(e),o=(n=r[this.defaults.ajax.url])&&n[e+"Token"],n||(n=r[this.defaults.ajax.url]={}),o||(i=this.get({action:"query",meta:"tokens",type:e,assert:t}),s=function(){return delete n[e+"Token"],$.Deferred().rejectWith(this,arguments)},o=i.then(function(t){return t.query?t.query.tokens[e+"token"]?t.query.tokens[e+"token"]:$.Deferred().reject("token-missing",t):s("query-missing",t)},s).promise({abort:i.abort}),n[e+"Token"]=o),o},badToken:function(t){var e=r[this.defaults.ajax.url];t=l(t),e&&delete e[t+"Token"]}},mw.Api.errors=["ok-but-empty","timeout","duplicate","duplicate-archive","noimageinfo","uploaddisabled","nomodule","mustbeposted","badaccess-groups","missingresult","missingparam","invalid-file-key","copyuploaddisabled","mustbeloggedin","empty-file","file-too-large","filetype-missing","filetype-banned","filetype-banned-type","filename-tooshort","illegal-filename","verification-error","hookaborted","unknown-error","internal-error","overwrite","badtoken","fetchfileerror","fileexists-shared-forbidden","invalidtitle","notloggedin","autoblocked","blocked","stashfailed","stasherror","stashedfilenotfound","stashpathinvalid","stashfilestorage","stashzerolength","stashnotloggedin","stashwrongowner","stashnosuchfilekey"],mw.log.deprecate(mw.Api,"errors",mw.Api.errors,null,"mw.Api.errors"),mw.Api.warnings=["duplicate","exists"],mw.log.deprecate(mw.Api,"warnings",mw.Api.warnings,null,"mw.Api.warnings")}(),function(){function s(t,e){if(!t||$.isPlainObject(t))throw new Error("mw.ForeignApi() requires a `url` parameter");this.apiUrl=String(t),this.anonymous=e&&e.anonymous,e=$.extend(!0,{ajax:{url:this.apiUrl,xhrFields:{withCredentials:!this.anonymous}},parameters:{origin:this.getOrigin()}},e),s.parent.call(this,e)}OO.inheritClass(s,mw.Api),s.prototype.getOrigin=function(){var t;return this.anonymous?"*":(t=location.protocol+"//"+location.hostname,location.port&&(t+=":"+location.port),t)},s.prototype.ajax=function(t,e){var i,n,o;return o="POST"===e.type?(i=e&&e.url||this.defaults.ajax.url,n=t&&t.origin||this.defaults.parameters.origin,i+=(-1!==i.indexOf("?")?"&":"?")+"origin="+encodeURIComponent(n).replace(/\./g,"%2E"),$.extend({},e,{url:i})):e,s.parent.prototype.ajax.call(this,t,o)},mw.ForeignApi=s}(),mw.loader.implement("mediawiki.String",function(t,e,i,n){!function(){function o(t){return t.replace(/[\u0080-\u07FF\uD800-\uDFFF]/g,"**").replace(/[\u0800-\uD7FF\uE000-\uFFFF]/g,"***").length}function s(t){return t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"*").length}function h(t,e,i){var n=i?t.slice(e-1,e+1):t.slice(e,e+2);return/^[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(n)?n:t.charAt(e)}function r(t,e,i,n){var o,s,r,l,a,u,c=t;if(n(e)<=i)return{newVal:e,trimmed:!1};for(s=o=0,r=Math.min(e.length,c.length);o<r&&(u=h(c,o,!1))===h(e,o,!1);)o+=u.length;for(;s<r-o&&(u=h(c,c.length-1-s,!0))===h(e,e.length-1-s,!0);)s+=u.length;for(l=[e.slice(0,o),e.slice(o,e.length-s),e.slice(e.length-s)];n(l.join(""))>i&&0<l[1].length;)a=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(l[1])?2:1,l[1]=l[1].slice(0,-a);return{newVal:l.join(""),trimmed:e!==l.join("")}}n.exports={byteLength:o,codePointLength:s,trimByteLength:function(t,e,i,n){return r(t,e,i,n?function(t){return o(n(t))}:o)},trimCodePointLength:function(t,e,i,n){return r(t,e,i,n?function(t){return s(n(t))}:s)}}}()}),mw.loader.implement("./phpCharToUpper.json",function(t,e,i,n){n.exports={"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}});var mwString=require("mediawiki.String"),toUpperMapping=require("./phpCharToUpper.json"),namespaceIds=mw.config.get("wgNamespaceIds"),NS_MAIN=namespaceIds[""],NS_TALK=namespaceIds.talk,NS_SPECIAL=namespaceIds.special,NS_MEDIA=namespaceIds.media,NS_FILE=namespaceIds.file,FILENAME_MAX_BYTES=240,TITLE_MAX_BYTES=255,getNsIdByName=function(t){var e;return"string"==typeof t&&(void 0!==(e=mw.config.get("wgNamespaceIds")[t.toLowerCase()])&&e)},getNamespacePrefix=function(t){return t===NS_MAIN?"":mw.config.get("wgFormattedNamespaces")[t].replace(/ /g,"_")+":"},rUnderscoreTrim=/^_+|_+$/g,rSplit=/^(.+?)_*:_*(.*)$/,rInvalid=new RegExp("[^"+mw.config.get("wgLegalTitleChars")+"]|%[0-9A-Fa-f]{2}|&[A-Za-z0-9-]+;|&#[0-9]+;|&#x[0-9A-Fa-f]+;"),rWhitespace=/[ _\u00A0\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]+/g,rUnicodeBidi=/[\u200E\u200F\u202A-\u202E]/g,sanitationRules=[{pattern:/~{3}/g,replace:"",generalRule:!0},{pattern:/[\x00-\x1f\x7f]/g,replace:"",generalRule:!0},{pattern:/%([0-9A-Fa-f]{2})/g,replace:"% $1",generalRule:!0},{pattern:/&(([A-Za-z0-9\x80-\xff]+|#[0-9]+|#x[0-9A-Fa-f]+);)/g,replace:"& $1",generalRule:!0},{pattern:new RegExp("["+mw.config.get("wgIllegalFileChars","")+"]","g"),replace:"-",fileRule:!0},{pattern:/[}\]>]/g,replace:")",generalRule:!0},{pattern:/[{[<]/g,replace:"(",generalRule:!0},{pattern:new RegExp(rInvalid.source,"g"),replace:"-",generalRule:!0},{pattern:/^(\.|\.\.|\.\/.*|\.\.\/.*|.*\/\.\/.*|.*\/\.\.\/.*|.*\/\.|.*\/\.\.)$/g,replace:"",generalRule:!0}],parse=function(t,e){var i,n,o,s,r,l;return i=void 0===e?NS_MAIN:e,""!==(t=t.replace(rUnicodeBidi,"").replace(rWhitespace,"_").replace(rUnderscoreTrim,""))&&":"===t[0]&&(i=NS_MAIN,t=t.slice(1).replace(rUnderscoreTrim,"")),""!==t&&((!(n=t.match(rSplit))||!1===(o=getNsIdByName(n[1]))||(i=o,t=n[2],i!==NS_TALK||!(n=t.match(rSplit))||!1===getNsIdByName(n[1])))&&(-1===(s=t.indexOf("#"))?r=null:(r=t.slice(s+1).replace(/_/g," "),t=t.slice(0,s).replace(rUnderscoreTrim,"")),!t.match(rInvalid)&&((-1===t.indexOf(".")||"."!==t&&".."!==t&&0!==t.indexOf("./")&&0!==t.indexOf("../")&&-1===t.indexOf("/./")&&-1===t.indexOf("/../")&&"/."!==t.slice(-2)&&"/.."!==t.slice(-3))&&(-1===t.indexOf("~~~")&&(!(i!==NS_SPECIAL&&mwString.byteLength(t)>TITLE_MAX_BYTES)&&((""!==t||i===NS_MAIN)&&(":"!==t[0]&&(-1===(s=t.lastIndexOf("."))||t.length<=s+1?l=null:(l=t.slice(s+1),t=t.slice(0,s)),{namespace:i,title:t,ext:l,fragment:r}))))))))},text=function(t){return t.replace(/_/g," ")},sanitize=function(t,e){var i,n,o,s,r,l=sanitationRules;for(i=0,n=l.length;i<n;++i)for(o=l[i],s=0,r=e.length;s<r;++s)o[e[s]]&&(t=t.replace(o.pattern,o.replace));return t},trimToByteLength=function(t,e){return mwString.trimByteLength("",t,e).newVal},trimFileNameToByteLength=function(t,e){return trimToByteLength(t,FILENAME_MAX_BYTES-e.length-1)+"."+e};function Title(t,e){var i=parse(t,e);if(!i)throw new Error("Unable to parse title");this.namespace=i.namespace,this.title=i.title,this.ext=i.ext,this.fragment=i.fragment}Title.newFromText=function(t,e){var i,n=parse(t,e);return n?((i=Object.create(Title.prototype)).namespace=n.namespace,i.title=n.title,i.ext=n.ext,i.fragment=n.fragment,i):null},Title.makeTitle=function(t,e){return mw.Title.newFromText(getNamespacePrefix(t)+e)},Title.newFromUserInput=function(t,e,i){var n,o,s,r,l,a;if(arguments.length<3&&"object"==typeof a?i=e:a=e,i=$.extend({forUploading:!0},i),n=void 0===a?NS_MAIN:a,""!==(t=t.replace(/\s/g," ").trim())&&":"===t[0]&&(n=NS_MAIN,t=t.substr(1).replace(rUnderscoreTrim,"")),(o=t.match(rSplit))&&!1!==(s=getNsIdByName(o[1]))&&(n=s,t=o[2]),n===NS_MEDIA||i.forUploading&&n===NS_FILE){if(-1===(l=(t=sanitize(t,["generalRule","fileRule"])).lastIndexOf("."))||l>=t.length-1)return null;r=t.slice(l+1),t=t.slice(0,l).trim(),t=trimFileNameToByteLength(t,r)}else t=sanitize(t,["generalRule"]),n!==NS_SPECIAL&&(t=trimToByteLength(t,TITLE_MAX_BYTES));return t=t.replace(/^:+/,""),Title.newFromText(t,n)},Title.newFromFileName=function(t){return Title.newFromUserInput("File:"+t,{forUploading:!0})},Title.newFromImg=function(t){var e,i,n,o,s,r=[/\/[a-f0-9]\/[a-f0-9]{2}\/([^\s/]+)\/[^\s/]+-[^\s/]*$/,/\/[a-f0-9]\/[a-f0-9]{2}\/([^\s/]+)$/,/\/([^\s/]+)\/[^\s/]+-(?:\1|thumbnail)[^\s/]*$/,/\/([^\s/]+)$/],l=r.length;if(e=(o=t.jquery?t[0].src:t.src).match(/thumb\.php/))return mw.Title.newFromText("File:"+mw.util.getParamValue("f",o));for(s=decodeURIComponent(o),i=0;i<l;i++)if(n=r[i],(e=s.match(n))&&e[1])return mw.Title.newFromText("File:"+e[1]);return null},Title.isTalkNamespace=function(t){return!!(NS_MAIN<t&&t%2)},Title.wantSignaturesNamespace=function(t){return Title.isTalkNamespace(t)||-1!==mw.config.get("wgExtraSignatureNamespaces").indexOf(t)},Title.exists=function(t){var e,i=Title.exist.pages;if("string"==typeof t)e=i[t];else{if(!(t instanceof Title))throw new Error("mw.Title.exists: title must be a string or an instance of Title");e=i[t.toString()]}return"boolean"!=typeof e?null:e},Title.exist={pages:{},set:function(t,e){var i,n,o=this.pages;for(e=void 0===e||!!e,i=0,n=(t=Array.isArray(t)?t:[t]).length;i<n;i++)o[t[i]]=e;return!0}},Title.normalizeExtension=function(t){var e=t.toLowerCase(),i={htm:"html",jpeg:"jpg",mpeg:"mpg",tiff:"tif",ogv:"ogg"};return Object.prototype.hasOwnProperty.call(i,e)?i[e]:/^[0-9a-z]+$/.test(e)?e:""},Title.phpCharToUpper=function(t){return toUpperMapping[t]||t.toUpperCase()},Title.prototype={constructor:Title,getNamespaceId:function(){return this.namespace},getNamespacePrefix:function(){return getNamespacePrefix(this.namespace)},getName:function(){return-1===mw.config.get("wgCaseSensitiveNamespaces").indexOf(this.namespace)&&this.title.length?mw.Title.phpCharToUpper(this.title[0])+this.title.slice(1):this.title},getNameText:function(){return text(this.getName())},getExtension:function(){return this.ext},getDotExtension:function(){return null===this.ext?"":"."+this.ext},getMain:function(){return this.getName()+this.getDotExtension()},getMainText:function(){return text(this.getMain())},getPrefixedDb:function(){return this.getNamespacePrefix()+this.getMain()},getPrefixedText:function(){return text(this.getPrefixedDb())},getRelativeText:function(t){return this.getNamespaceId()===t?this.getMainText():this.getNamespaceId()===NS_MAIN?":"+this.getPrefixedText():this.getPrefixedText()},getFragment:function(){return this.fragment},getUrl:function(t){var e=this.getFragment();return e?mw.util.getUrl(this.toString()+"#"+e,t):mw.util.getUrl(this.toString(),t)},isTalkPage:function(){return Title.isTalkNamespace(this.getNamespaceId())},getTalkPage:function(){return this.canHaveTalkPage()?this.isTalkPage()?this:Title.makeTitle(this.getNamespaceId()+1,this.getMainText()):null},getSubjectPage:function(){return this.isTalkPage()?Title.makeTitle(this.getNamespaceId()-1,this.getMainText()):this},canHaveTalkPage:function(){return this.getNamespaceId()>=NS_MAIN},exists:function(){return Title.exists(this)}},Title.prototype.toString=Title.prototype.getPrefixedDb,Title.prototype.toText=Title.prototype.getPrefixedText,mw.Title=Title,function(){var f=Object.prototype.hasOwnProperty;mw.widgets.TitleWidget=function(t){t=$.extend({maxLength:255,limit:10},t),this.limit=t.limit,this.maxLength=t.maxLength,this.namespace=void 0!==t.namespace?t.namespace:null,this.relative=void 0===t.relative||t.relative,this.suggestions=void 0===t.suggestions||t.suggestions,this.showRedirectTargets=!1!==t.showRedirectTargets,this.showImages=!!t.showImages,this.showDescriptions=!!t.showDescriptions,this.showMissing=!1!==t.showMissing,this.showInterwikis=!!t.showInterwikis,this.addQueryInput=!1!==t.addQueryInput,this.excludeCurrentPage=!!t.excludeCurrentPage,this.excludeDynamicNamespaces=!!t.excludeDynamicNamespaces,this.validateTitle=void 0===t.validateTitle||t.validateTitle,this.highlightSearchQuery=void 0===t.highlightSearchQuery||!!t.highlightSearchQuery,this.cache=t.cache,this.api=t.api||new mw.Api,this.compare=window.Intl&&Intl.Collator?new Intl.Collator(mw.config.get("wgContentLanguage"),{sensitivity:"base"}).compare:null,this.$element.addClass("mw-widget-titleWidget")},OO.initClass(mw.widgets.TitleWidget),mw.widgets.TitleWidget.static.interwikiPrefixesPromiseCache={},mw.widgets.TitleWidget.prototype.getQueryValue=null,mw.widgets.TitleWidget.prototype.getNamespace=function(){return this.namespace},mw.widgets.TitleWidget.prototype.setNamespace=function(t){this.namespace=t},mw.widgets.TitleWidget.prototype.getInterwikiPrefixesPromise=function(){var t,e,i;return this.showInterwikis?(t=this.getApi(),e=this.constructor.static.interwikiPrefixesPromiseCache,i=t.defaults.ajax.url,Object.prototype.hasOwnProperty.call(e,i)||(e[i]=t.get({action:"query",meta:"siteinfo",siprop:"interwikimap",maxage:86400,smaxage:86400,uselang:"content"}).then(function(t){return t.query.interwikimap.map(function(t){return t.prefix})})),e[i]):$.Deferred().resolve([]).promise()},mw.widgets.TitleWidget.prototype.getSuggestionsPromise=function(){var i,n=this.getApi(),o=this.getQueryValue(),s=this,r={abort:function(){}};return mw.Title.newFromText(o)?this.getInterwikiPrefixesPromise().then(function(t){var e;return t.length&&(e=o.substring(0,o.indexOf(":")))&&""!==e&&-1!==t.indexOf(e)?$.Deferred().resolve({query:{pages:[{title:o}]}}).promise(r):(i=n.get(s.getApiParams(o)),r.abort=i.abort.bind(i),i.then(function(t){return s.showMissing&&void 0===t.query&&(t=n.get({action:"query",titles:o}),r.abort=t.abort.bind(t)),t}))}).promise(r):$.Deferred().resolve({}).promise(r)},mw.widgets.TitleWidget.prototype.getApiParams=function(t){var e={action:"query",prop:["info","pageprops"],generator:"prefixsearch",gpssearch:t,gpsnamespace:null!==this.namespace?this.namespace:void 0,gpslimit:this.limit,ppprop:"disambiguation"};return this.showRedirectTargets&&(e.redirects=!0),this.showImages&&(e.prop.push("pageimages"),e.pithumbsize=80,e.pilimit=this.limit),this.showDescriptions&&e.prop.push("description"),e},mw.widgets.TitleWidget.prototype.getApi=function(){return this.api},mw.widgets.TitleWidget.prototype.getOptionsFromData=function(t){var e,i,n,o,s,r,l,a,u,c=new mw.Title(mw.config.get("wgRelevantPageName")).getPrefixedText(),h=[],p=[],d=mw.Title.newFromText(this.getQueryValue()),m={},g={};if(t.redirects)for(e=0,i=t.redirects.length;e<i;e++)m[(a=t.redirects[e]).to]=m[a.to]||[],m[a.to].push(a.from);for(n in t.pages)if(r=t.pages[n],!(this.excludeCurrentPage&&r.title===c&&r.title!==d.getPrefixedText()||this.excludeDynamicNamespaces&&r.ns<0))for(g[r.title]={known:void 0!==r.known,missing:void 0!==r.missing,redirect:void 0!==r.redirect,disambiguation:void 0!==OO.getProp(r,"pageprops","disambiguation"),imageUrl:OO.getProp(r,"thumbnail","source"),description:r.description,index:r.index,originalData:r},null!==this.namespace&&this.namespace!==r.ns||p.push(r.title),e=0,i=(u=f.call(m,r.title)?m[r.title]:[]).length;e<i;e++)g[u[e]]={missing:!1,known:!0,redirect:!0,disambiguation:!1,description:mw.msg("mw-widgets-titleinput-description-redirect",r.title),index:r.index+.5,originalData:r},p.push(u[e]);for(p.sort(function(t,e){return g[t].index-g[e].index}),o=(s=f.call(g,this.getQueryValue())&&(!g[this.getQueryValue()].missing||g[this.getQueryValue()].known))||d&&f.call(g,d.getPrefixedText())&&(!g[d.getPrefixedText()].missing||g[d.getPrefixedText()].known),this.cache&&this.cache.set(g),this.addQueryInput&&o&&!s&&p.unshift(this.getQueryValue()),e=0,i=p.length;e<i;e++)l=f.call(g,p[e])?g[p[e]]:{},h.push(this.createOptionWidget(this.getOptionWidgetData(p[e],l)));return h},mw.widgets.TitleWidget.prototype.createOptionWidget=function(t){return new mw.widgets.TitleOptionWidget(t)},mw.widgets.TitleWidget.prototype.getOptionWidgetData=function(t,e){var i=new mw.Title(t),n=e.description;return e.missing&&!n&&(n=mw.msg("mw-widgets-titleinput-description-new-page")),{data:null!==this.namespace&&this.relative?i.getRelativeText(this.namespace):t,url:i.getUrl(),showImages:this.showImages,imageUrl:this.showImages?e.imageUrl:null,description:this.showDescriptions?n:null,missing:e.missing,redirect:e.redirect,disambiguation:e.disambiguation,query:this.highlightSearchQuery?this.getQueryValue():null,compare:this.compare}},mw.widgets.TitleWidget.prototype.getMWTitle=function(t){var e=void 0!==t?t:this.getQueryValue();return mw.Title.newFromText(e,null!==this.namespace?this.namespace:void 0)},mw.widgets.TitleWidget.prototype.isQueryValid=function(){return!this.validateTitle||(!this.required&&""===this.getQueryValue()||!!this.getMWTitle())}}(),mw.widgets.TitleOptionWidget=function(t){var e;e=t.showImages?t.missing?"articleNotFound":t.redirect?"articleRedirect":t.disambiguation?"articleDisambiguation":"article":null,t=$.extend({icon:e,label:t.data,autoFitLabel:!1,$label:$("<a>")},t),mw.widgets.TitleOptionWidget.parent.call(this,t),this.checkIcon.$element.remove(),this.$label.attr("href",t.url),this.$element.addClass("mw-widget-titleOptionWidget"),this.$label.attr("tabindex","-1"),this.$label.on("click",function(t){1!==t.which||t.altKey||t.ctrlKey||t.shiftKey||t.metaKey||t.preventDefault()}),t.query&&this.setHighlightedQuery(t.data,t.query,t.compare),this.$label.attr("title",t.data),t.missing?this.$label.addClass("new"):t.redirect?this.$label.addClass("mw-redirect"):t.disambiguation&&this.$label.addClass("mw-disambig"),t.showImages&&t.imageUrl&&this.$icon.addClass("mw-widget-titleOptionWidget-hasImage").css("background-image","url("+t.imageUrl+")"),t.description&&this.$element.append($("<span>").addClass("mw-widget-titleOptionWidget-description").text(t.description).attr("title",t.description))},OO.inheritClass(mw.widgets.TitleOptionWidget,OO.ui.MenuOptionWidget),function(){var e=require("mediawiki.String").trimByteLength;mw.widgets.TitleInputWidget=function(t){t=t||{},mw.widgets.TitleInputWidget.parent.call(this,$.extend({},t,{validate:void 0!==t.validate?t.validate:this.isQueryValid.bind(this),autocomplete:!1})),mw.widgets.TitleWidget.call(this,t),OO.ui.mixin.LookupElement.call(this,t),this.suggestions=void 0===t.suggestions||t.suggestions,this.$element.addClass("mw-widget-titleInputWidget"),this.lookupMenu.$element.addClass("mw-widget-titleWidget-menu"),this.showImages&&this.lookupMenu.$element.addClass("mw-widget-titleWidget-menu-withImages"),this.showDescriptions&&this.lookupMenu.$element.addClass("mw-widget-titleWidget-menu-withDescriptions"),this.setLookupsDisabled(!this.suggestions)},OO.inheritClass(mw.widgets.TitleInputWidget,OO.ui.TextInputWidget),OO.mixinClass(mw.widgets.TitleInputWidget,mw.widgets.TitleWidget),OO.mixinClass(mw.widgets.TitleInputWidget,OO.ui.mixin.LookupElement),mw.widgets.TitleInputWidget.prototype.getQueryValue=function(){return this.getValue()},mw.widgets.TitleInputWidget.prototype.setNamespace=function(t){mw.widgets.TitleWidget.prototype.setNamespace.call(this,t),this.lookupCache={},this.closeLookupMenu()},mw.widgets.TitleInputWidget.prototype.getLookupRequest=function(){return this.getSuggestionsPromise()},mw.widgets.TitleInputWidget.prototype.getLookupCacheDataFromResponse=function(t){return t.query||{}},mw.widgets.TitleInputWidget.prototype.getLookupMenuOptionsFromData=function(t){return this.getOptionsFromData(t)},mw.widgets.TitleInputWidget.prototype.onLookupMenuItemChoose=function(t){this.closeLookupMenu(),this.setLookupsDisabled(!0),this.setValue(t.getData()),this.setLookupsDisabled(!this.suggestions)},mw.widgets.TitleInputWidget.prototype.focus=function(){var t;return this.setLookupsDisabled(!0),t=mw.widgets.TitleInputWidget.parent.prototype.focus.apply(this,arguments),this.setLookupsDisabled(!this.suggestions),t},mw.widgets.TitleInputWidget.prototype.cleanUpValue=function(t){var i=this;return t=mw.widgets.TitleInputWidget.parent.prototype.cleanUpValue.call(this,t),e(this.value,t,this.maxLength,function(t){var e=i.getMWTitle(t);return e?e.getMain():t}).newVal}}();